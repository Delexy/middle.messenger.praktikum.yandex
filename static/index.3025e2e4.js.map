{"mappings":"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","sources":["src/utils/queryStringify.ts","src/Modules/HTTPTransport/HTTPTransport.ts","src/API/BaseAPI.ts","src/API/AuthAPI.ts","src/pages/registration/template.pug","src/components/EventBus/EventBus.ts","node_modules/uuid/dist/esm-browser/native.js","node_modules/uuid/dist/esm-browser/rng.js","node_modules/uuid/dist/esm-browser/stringify.js","node_modules/uuid/dist/esm-browser/v4.js","src/utils/isArrayOrObject.ts","src/utils/deepEqual.ts","src/components/Block/Block.ts","src/components/Input/template.pug","src/utils/projectVariables.ts","src/components/Input/Input.ts","src/components/Form/template.pug","src/components/Form/Form.ts","src/components/Button/template.pug","src/components/Button/Button.ts","src/utils/dataPrepare.ts","src/utils/merge.ts","src/utils/set.ts","src/Modules/Store/Store.ts","src/Controllers/AuthController.ts","src/pages/registration/RegistrationController.ts","src/pages/registration/RegistrationAPI.ts","src/pages/registration/RegistrationPage.ts","src/pages/authentication/template.pug","src/pages/authentication/AuthController.ts","src/pages/authentication/AuthPageAPI.ts","src/pages/authentication/AuthPage.ts","src/pages/pagination/template.pug","src/pages/pagination/Pagination.ts","src/pages/profile/template.pug","src/components/Photo/template.pug","src/components/FormFile/template.pug","src/components/FileInput/template.pug","src/components/FileInput/FileInput.ts","src/components/FormFile/FormFile.ts","src/components/Photo/Photo.ts","src/utils/defaultPhoto.ts","src/components/ErrorHandler/ErrorHandler.ts","src/pages/profile/ProfileAPI.ts","src/pages/profile/ProfileController.ts","src/pages/profile/Profile.ts","src/pages/profileEdit/template.pug","src/API/ProfileAPI.ts","src/pages/profileEdit/ProfileEditController.ts","src/pages/profileEdit/ProfileEditAPI.ts","src/pages/profileEdit/ProfileEdit.ts","src/pages/changePassword/template.pug","src/pages/changePassword/ChangePasswordAPI.ts","src/pages/changePassword/ChangePasswordController.ts","src/pages/changePassword/ChangePassword.ts","src/pages/main/template.pug","src/components/ChatEl/template.pug","src/components/ChatEl/ChatEl.ts","src/components/ActiveChat/template.pug","src/components/Message/template.pug","src/components/Message/Message.ts","src/components/SmallForm/template.pug","src/components/SmallForm/SmallForm.ts","src/components/MessageForm/template.pug","src/components/MessageForm/MessageForm.ts","src/components/ActiveChat/ActiveChat.ts","src/pages/main/ChatsAPI.ts","src/API/UserAPI.ts","src/API/ChatAPI.ts","src/pages/main/ChatsController.ts","src/utils/escape.ts","src/pages/main/Chats.ts","src/pages/errors/template.pug","src/pages/errors/ErrorPage.ts","src/utils/renderDOM.ts","src/pages/errors/404.ts","src/pages/errors/500.ts","src/Modules/Router/Route.ts","src/Modules/Router/Router.ts","src/pages/index.ts"],"sourcesContent":["type StringIndexed = Record<string, any>;\r\n\r\nfunction isPlainObject(value: unknown): value is StringIndexed {\r\n    return typeof value === 'object'\r\n        && value !== null\r\n        && value.constructor === Object\r\n        && Object.prototype.toString.call(value) === '[object Object]';\r\n}\r\n\r\nfunction isArray(value: unknown): value is [] {\r\n    return Array.isArray(value);\r\n}\r\n\r\nfunction isArrayOrObject(value: unknown): value is [] | StringIndexed {\r\n    return isPlainObject(value) || isArray(value);\r\n}\r\n\r\nfunction queryStringify(data: StringIndexed): string | never {\r\n  const resultStr = [];\r\n  for (const key in data) {\r\n    if (isArrayOrObject(data[key])) {\r\n      Object.entries(data[key]).forEach(([subkey, subval]) => {\r\n        if(isArrayOrObject(subval)) {\r\n          resultStr.push(`${key}[${subkey}]${queryStringify({'': subval})}`);\r\n        } else {\r\n          resultStr.push(`${key}[${subkey}]=${subval}`);\r\n        }\r\n      });\r\n    }\r\n    else {\r\n      resultStr.push(`${key}=${data[key]}`);\r\n    }\r\n  }\r\n  return resultStr.join(`&`);\r\n}\r\n\r\nexport default queryStringify\r\n","import queryStringify from \"../../utils/queryStringify\";\r\n\r\nconst METHODS: Record<string, string> = {\r\n  GET: \"GET\",\r\n  PUT: \"PUT\",\r\n  POST: \"POST\",\r\n  DELETE: \"DELETE\",\r\n};\r\n\r\ntype ResponseType = {\r\n  status: number;\r\n  response?: {\r\n    [key: string]: unknown;\r\n    reason?: string;\r\n  };\r\n};\r\n\r\nclass HTTPTransport<T = ResponseType> {\r\n  private _baseUrl: string;\r\n\r\n  constructor(baseUrl = \"\") {\r\n    this._baseUrl = baseUrl;\r\n  }\r\n\r\n  get = (url: string, options: Record<string, any> = { timeout: 5000 }): Promise<T> => {\r\n    return this.request(this._baseUrl + url, { ...options, method: METHODS.GET }, options.timeout);\r\n  };\r\n  put = (url: string, options: Record<string, any> = { timeout: 5000 }): Promise<T> => {\r\n    return this.request(this._baseUrl + url, { ...options, method: METHODS.PUT }, options.timeout);\r\n  };\r\n  post = (url: string, options: Record<string, any> = { timeout: 5000 }): Promise<T> => {\r\n    return this.request(this._baseUrl + url, { ...options, method: METHODS.POST }, options.timeout);\r\n  };\r\n  delete = (url: string, options: Record<string, any> = { timeout: 5000 }): Promise<T> => {\r\n    return this.request(this._baseUrl + url, { ...options, method: METHODS.DELETE }, options.timeout);\r\n  };\r\n\r\n  request = (url: string, options: Record<string, any> = { method: METHODS.GET, data: \"\" }, timeout = 5000): Promise<T> => {\r\n    return new Promise((resolve, reject) => {\r\n      const { headers } = options;\r\n      let { method, data } = options;\r\n      if (!method) {\r\n        method = METHODS.GET;\r\n      }\r\n      const xhr = new XMLHttpRequest();\r\n      xhr.open(method, url);\r\n      xhr.withCredentials = true;\r\n\r\n      const handleError = (err: Error) => {\r\n        reject({ status: 0, response: { reason: err.message } });\r\n      };\r\n\r\n      if (method === METHODS.GET && data) {\r\n        data = queryStringify(data);\r\n        url += `?${data}`;\r\n      }\r\n\r\n      // Headers\r\n      if (headers) {\r\n        for (const header in headers) {\r\n          xhr.setRequestHeader(header, headers[header]);\r\n        }\r\n      }\r\n\r\n      // Errors and abort\r\n      xhr.onerror = handleError as () => never;\r\n      xhr.onabort = handleError as () => never;\r\n      xhr.ontimeout = () => {\r\n        reject({ status: 0, response: \"Timeout\" });\r\n      };\r\n\r\n      const timer = setTimeout(() => {\r\n        xhr.abort();\r\n      }, timeout);\r\n\r\n      // Send request\r\n      xhr.onload = function () {\r\n        try {\r\n          resolve({ status: xhr.status, response: JSON.parse(xhr.response) } as T);\r\n        } catch (err) {\r\n          resolve({ status: xhr.status, response: xhr.response } as T);\r\n        }\r\n        clearTimeout(timer);\r\n      };\r\n\r\n      if (method === METHODS.GET || !data) {\r\n        xhr.send();\r\n      } else {\r\n        xhr.send(data);\r\n      }\r\n    });\r\n  };\r\n}\r\n\r\nfunction fetchWithRetry(url: string, options = { retries: 5 }) {\r\n  let retriesAmount = options?.retries;\r\n  const http = new HTTPTransport();\r\n\r\n  const handler: any = (xhr: XMLHttpRequest) => {\r\n    if (`${xhr.status}`.startsWith(\"2\")) {\r\n      return xhr;\r\n    } else {\r\n      retriesAmount--;\r\n      if (retriesAmount > 0) {\r\n        return http.request(url, options).then(handler).catch(handler);\r\n      } else {\r\n        throw new Error(\"Error\");\r\n      }\r\n    }\r\n  };\r\n\r\n  return http.request(url, options).then(handler).catch(handler);\r\n}\r\n\r\nexport { HTTPTransport as default, fetchWithRetry };\r\n","import HTTP from \"../Modules/HTTPTransport/HTTPTransport\"\r\n\r\nexport default class BaseAPI {\r\n\tprotected HTTPEntity: HTTP;\r\n\r\n\tconstructor(baseUrl?: string) {\r\n\t\tthis.HTTPEntity = new HTTP(`https://ya-praktikum.tech/api/v2${baseUrl || ''}`);\r\n\t}\r\n}\r\n","import BaseAPI from \"./BaseAPI\";\r\n\r\nclass AuthAPI extends BaseAPI {\r\n  constructor() {\r\n    super('/auth');\r\n  }\r\n\r\n  async getUser() {\r\n    const { status, response } = await this.HTTPEntity.get(\"/user\");\r\n\r\n    if(status === 200) {\r\n      return response;\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  logout() {\r\n    return this.HTTPEntity.post(\"/logout\");\r\n  }\r\n}\r\n\r\nexport default AuthAPI;\r\n",".auth-page\r\n\t.auth-page__content \r\n\t\t| !{ RegistrationForm }\r\n","type Listener = (...args: unknown[]) => void;\r\n\r\nclass EventBus {\r\n  listeners: { [key: string]: Listener[] };\r\n\r\n  constructor() {\r\n    this.listeners = {};\r\n  }\r\n\r\n  on(event: string, callback: Listener): void {\r\n    if (!this.listeners[event]) {\r\n      this.listeners[event] = [];\r\n    }\r\n\r\n    this.listeners[event].push(callback);\r\n  }\r\n\r\n  off(event: string, callback: Listener): void {\r\n    if (!this.listeners[event]) {\r\n      throw new Error(`Нет события: ${event}`);\r\n    }\r\n\r\n    this.listeners[event] = this.listeners[event].filter((listener) => listener !== callback);\r\n  }\r\n\r\n  emit(event: string, ...args: unknown[]): void {\r\n    if (!this.listeners[event]) {\r\n      throw new Error(`Нет события: ${event}`);\r\n    }\r\n\r\n    this.listeners[event].forEach(function (listener) {\r\n      listener(...args);\r\n    });\r\n  }\r\n}\r\n\r\nexport default EventBus;\r\n","const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nexport default {\n  randomUUID\n};","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nlet getRandomValues;\nconst rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nconst byteToHex = [];\n\nfor (let i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).slice(1));\n}\n\nexport function unsafeStringify(arr, offset = 0) {\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  return (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase();\n}\n\nfunction stringify(arr, offset = 0) {\n  const uuid = unsafeStringify(arr, offset); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  if (native.randomUUID && !buf && !options) {\n    return native.randomUUID();\n  }\n\n  options = options || {};\n  const rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (let i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return unsafeStringify(rnds);\n}\n\nexport default v4;","type PlainObject<T = any> = {\r\n\t[k in string]: T;\r\n};\r\n\r\nexport function isPlainObject(value: unknown): value is PlainObject {\r\n\treturn typeof value === 'object'\r\n\t\t\t&& value !== null\r\n\t\t\t&& value.constructor === Object\r\n\t\t\t&& Object.prototype.toString.call(value) === '[object Object]';\r\n}\r\n\r\nexport function isArray(value: unknown): value is [] {\r\n\treturn Array.isArray(value);\r\n}\r\n\r\nexport function isArrayOrObject(value: unknown): value is [] | PlainObject {\r\n\treturn isPlainObject(value) || isArray(value);\r\n}\r\n","import { isArrayOrObject } from \"./isArrayOrObject\";\r\n\r\nfunction deepEqual(lhs: Record<string, any>, rhs: Record<string, any>): boolean {\r\n  if (Object.keys(lhs).length !== Object.keys(rhs).length) {\r\n    return false;\r\n  }\r\n\r\n  for (const [key, value] of Object.entries(lhs)) {\r\n    const rightValue = rhs[key];\r\n    if (isArrayOrObject(value) && isArrayOrObject(rightValue)) {\r\n      if (deepEqual(value, rightValue)) {\r\n        continue;\r\n      }\r\n      return false;\r\n    }\r\n\r\n    if (value !== rightValue) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\nexport default deepEqual;\r\n","import EventBus from \"../EventBus/EventBus\";\r\nimport { v4 as createId } from \"uuid\";\r\nimport { compileTemplate } from \"pug\";\r\nimport deepEqual from \"../../utils/deepEqual\";\r\n\r\nenum EVENTS {\r\n  INIT = \"init\",\r\n  FLOW_CDM = \"flow:component-did-mount\",\r\n  FLOW_CDU = \"flow:component-did-update\",\r\n  FLOW_CU = \"flow:component-updated\",\r\n  FLOW_RENDER = \"flow:render\",\r\n  FLOW_UM = \"flow:component-unmount\"\r\n}\r\n\r\ninterface BlockProps {\r\n  [key: string]: any;\r\n}\r\n\r\nclass Block {\r\n  props: BlockProps;\r\n  _element: HTMLElement;\r\n  _meta;\r\n  _needUpdate: boolean;\r\n  id: string;\r\n  children: { [key: string]: Block | Block[] };\r\n  eventBus: () => EventBus;\r\n\r\n  constructor(propsAndChildren = {}) {\r\n    const eventBus = new EventBus();\r\n    const { children, props } = this._getChildren(propsAndChildren);\r\n\r\n    this.id = createId();\r\n    this._element;\r\n    this._meta = {\r\n      props,\r\n    };\r\n\r\n    this.props = this._makePropsProxy(props);\r\n    this.children = children;\r\n\r\n    this.eventBus = () => eventBus;\r\n\r\n    this._registerEvents(eventBus);\r\n    eventBus.emit(EVENTS.INIT);\r\n  }\r\n\r\n  private _registerEvents(eventBus: EventBus) {\r\n    eventBus.on(EVENTS.INIT, this._init.bind(this));\r\n    eventBus.on(EVENTS.FLOW_CDM, this._componentDidMount.bind(this));\r\n    eventBus.on(EVENTS.FLOW_CDU, this._componentDidUpdate.bind(this));\r\n    eventBus.on(EVENTS.FLOW_CU, this._componentUpdated.bind(this));\r\n    eventBus.on(EVENTS.FLOW_RENDER, this._render.bind(this));\r\n    eventBus.on(EVENTS.FLOW_UM, this._render.bind(this));\r\n  }\r\n\r\n  private _addEvents() {\r\n    const { events } = this.props;\r\n\r\n    if (events) {\r\n      Object.keys(events).forEach((eventName) => {\r\n        if (this._element) {\r\n          if (Array.isArray(events[eventName])) {\r\n            events[eventName].forEach((event: () => void) => this._element.addEventListener(eventName, event));\r\n          } else {\r\n            this._element.addEventListener(eventName, events[eventName]);\r\n          }\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  private _removeEvents() {\r\n    const { events } = this.props;\r\n\r\n    if (events) {\r\n      Object.keys(events).forEach((eventName) => {\r\n        if (this._element) {\r\n          if (Array.isArray(events[eventName])) {\r\n            events[eventName].forEach((event: () => void) => this._element.removeEventListener(eventName, event));\r\n          } else {\r\n            this._element.removeEventListener(eventName, events[eventName]);\r\n          }\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  private _getChildren(propsAndChildren: BlockProps) {\r\n    const children: BlockProps = {};\r\n    const props: BlockProps = {};\r\n\r\n    Object.entries(propsAndChildren).forEach(([key, value]) => {\r\n      if ((Array.isArray(value) && value[0] instanceof Block) || value instanceof Block) {\r\n        children[key] = value;\r\n      } else {\r\n        props[key] = value;\r\n      }\r\n    });\r\n\r\n    return { children, props };\r\n  }\r\n\r\n  _init() {\r\n    this.init();\r\n    this.eventBus().emit(EVENTS.FLOW_RENDER);\r\n  }\r\n\r\n  init() {\r\n    // Переопределяется пользователем\r\n  }\r\n\r\n  private _componentDidMount() {\r\n    this.componentDidMount();\r\n\r\n    Object.values(this.children).forEach((child) => {\r\n      if (Array.isArray(child)) {\r\n        child.forEach((subChild) => subChild.dispatchComponentDidMount());\r\n      } else {\r\n        child.dispatchComponentDidMount();\r\n      }\r\n    });\r\n  }\r\n\r\n  componentDidMount() {\r\n    // Может переопределять пользователь, необязательно трогать\r\n  }\r\n\r\n  dispatchComponentDidMount() {\r\n    this.eventBus().emit(EVENTS.FLOW_CDM);\r\n  }\r\n\r\n  _componentDidUpdate(oldProps?: BlockProps | unknown, newProps?: BlockProps | unknown) {\r\n    const response = this.componentDidUpdate(oldProps, newProps);\r\n\r\n    if (response) {\r\n      this.eventBus().emit(EVENTS.FLOW_RENDER);\r\n      this.eventBus().emit(EVENTS.FLOW_CU);\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(oldProps?: BlockProps | unknown, newProps?: BlockProps | unknown): boolean {\r\n    if (deepEqual(oldProps as Record<string, unknown>, newProps as Record<string, unknown>)) {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  _componentUpdated(): void {\r\n    this.componentUpdated();\r\n  }\r\n\r\n  componentUpdated(): void {\r\n    // Может переопределять пользователь, необязательно трогать\r\n  }\r\n\r\n  _componentBeforeUnmount(): void {\r\n    this._removeEvents();\r\n    this.componentBeforeUnmount();\r\n  }\r\n\r\n  componentBeforeUnmount(): void {\r\n    // Может переопределять пользователь, необязательно трогать\r\n  }\r\n\r\n  setProps = (nextProps: BlockProps) => {\r\n    if (!nextProps) {\r\n      return;\r\n    }\r\n\r\n    Object.assign(this.props, nextProps);\r\n  };\r\n\r\n  get element() {\r\n    return this._element;\r\n  }\r\n\r\n  _render() {\r\n    const block = this.render() as DocumentFragment;\r\n    this._removeEvents();\r\n\r\n    const newElement = block.firstChild;\r\n    if (this._element) {\r\n      this._element.replaceWith(block);\r\n    }\r\n\r\n    this._element = newElement as HTMLElement;\r\n    this._addEvents();\r\n  }\r\n\r\n  render() {\r\n    // Может переопределить пользователь\r\n    return \"\" as any;\r\n  }\r\n\r\n  compile(template: compileTemplate, props: BlockProps): DocumentFragment {\r\n    const propsAndStubs = { ...props };\r\n\r\n    Object.entries(this.children).forEach(([key, child]) => {\r\n      if (Array.isArray(child)) {\r\n        propsAndStubs[key] = child.map((subChild) => `<div data-id=\"${subChild.id}\"></div>`).join(\"\");\r\n      } else {\r\n        propsAndStubs[key] = `<div data-id=\"${child.id}\"></div>`;\r\n      }\r\n    });\r\n\r\n    const fragment = this._createDocumentElement(\"template\") as HTMLTemplateElement;\r\n\r\n    fragment.innerHTML = template(propsAndStubs);\r\n\r\n    Object.values(this.children).forEach((child: Block) => {\r\n      if (Array.isArray(child)) {\r\n        child.forEach((subChild) => {\r\n          const stub = fragment.content.querySelector(`[data-id=\"${subChild.id}\"]`);\r\n          if (stub) {\r\n            stub.replaceWith(subChild.getContent());\r\n          }\r\n        });\r\n      } else {\r\n        const stub = fragment.content.querySelector(`[data-id=\"${child.id}\"]`);\r\n        if (stub) {\r\n          stub.replaceWith(child.getContent());\r\n        }\r\n      }\r\n    });\r\n\r\n    return fragment.content;\r\n  }\r\n\r\n  getContent() {\r\n    return this.element;\r\n  }\r\n\r\n  private _makePropsProxy(props: BlockProps) {\r\n    props = new Proxy(props, {\r\n      get: (target: BlockProps, property: string) => {\r\n        return typeof target[property] === \"function\" ? target[property].bind(target) : target[property];\r\n      },\r\n      set: (target: BlockProps, property: string, value, receiver) => {\r\n        const oldProps = JSON.parse(JSON.stringify(target));\r\n        const isUpdated = Reflect.set(target, property, value, receiver);\r\n\r\n        this.eventBus().emit(EVENTS.FLOW_CDU, oldProps, target);\r\n\r\n        return isUpdated;\r\n      },\r\n    });\r\n\r\n    return props;\r\n  }\r\n\r\n  _createDocumentElement(tagName: string): HTMLElement {\r\n    // Можно сделать метод, который через фрагменты в цикле создаёт сразу несколько блоков\r\n    return document.createElement(tagName);\r\n  }\r\n\r\n  show() {\r\n    if (this.element) {\r\n      this.element.style.display = \"\";\r\n    }\r\n  }\r\n\r\n  hide() {\r\n    if (this.element) {\r\n      this.element.style.display = \"none\";\r\n    }\r\n  }\r\n\r\n  unmount() {\r\n    this.eventBus().emit(EVENTS.FLOW_UM);\r\n    if(this._element) {\r\n      this._element.outerHTML = \"\";\r\n    }\r\n  }\r\n}\r\n\r\nexport { Block as default, BlockProps };\r\n","label.input(class=className)\r\n\tinput.input__el(type='text')&attributes(attributes)\r\n\tif label\r\n\t\tspan.input__title= label\r\n\tif attributes.type === \"password\"\r\n\t\tbutton.input__eye(type=\"button\")\r\n\t\t\tinclude ../../imgs/icons/eye.svg\r\n\tspan.input__error-text= error\r\n","export const userData: Record<string, string | null> = {\r\n  email: \"\",\r\n  login: \"\",\r\n  first_name: \"\",\r\n  display_name: \"\",\r\n  second_name: \"\",\r\n  phone: \"\",\r\n  avatar: \"\",\r\n};\r\n\r\nexport const fieldsNaming = {\r\n  email: \"Почта\",\r\n  login: \"Логин\",\r\n  first_name: \"Имя\",\r\n  second_name: \"Фамилия\",\r\n  display_name: \"Имя в чате\",\r\n  phone: \"Телефон\",\r\n  avatar: \"Аватар\",\r\n  password: \"Пароль\",\r\n};\r\n\r\nexport const INPUT_VALIDATION_REGEXP: Record<string, RegExp> = {\r\n  login: new RegExp(/^(?=.*[A-Z])([A-Za-z0-9-_]{3,20})$/gm),\r\n  first_name: new RegExp(/^([A-ZА-Я]){1}([A-Za-zА-Яа-я-])+$/gm),\r\n  second_name: new RegExp(/^([A-ZА-Я]){1}([A-Za-zА-Яа-я-])+$/gm),\r\n  email: new RegExp(/^\\S+@\\S+\\.\\S+$/gi),\r\n  password: new RegExp(/^(?=.*[0-9])(?=.*[A-Z])([.\\S]{8,40})$/g),\r\n  phone: new RegExp(/^\\+?[1-9][0-9]{10,15}$/gi),\r\n  message: new RegExp(/^.+$/gim),\r\n};\r\n\r\nexport const INPUT_ERRORS: Record<string, string> = {\r\n  login: \"Длина от 3 до 20 символов, первая буква заглавная\",\r\n  first_name: \"Поле введено неверно\",\r\n  second_name: \"Поле введено неверно\",\r\n  email: \"Email введён неверно\",\r\n  password: \"Пароль должен быть от 8 до 40 символов\",\r\n  phone: \"Телефон введён неверно\",\r\n};\r\n","import template from \"./template.pug\";\r\nimport Block from \"../Block/Block\";\r\nimport { INPUT_VALIDATION_REGEXP, INPUT_ERRORS } from \"../../utils/projectVariables\";\r\n\r\ninterface InputProps {\r\n  label?: string;\r\n  className?: string;\r\n  attributes?: any;\r\n  error?: string;\r\n}\r\n\r\nclass Input extends Block {\r\n  value: string;\r\n\r\n  constructor(props: InputProps) {\r\n    super(props);\r\n    this.props.attributes.type = props.attributes.type || \"text\";\r\n    this.value = this.props.attributes.value || \"\";\r\n  }\r\n\r\n  validation(): boolean {\r\n    let inputIsValid = true;\r\n    if (this.props.attributes.name) {\r\n      inputIsValid = !!`${this.value}`.match(INPUT_VALIDATION_REGEXP[this.props.attributes.name]);\r\n\r\n      if (!inputIsValid) {\r\n        if(!this.props.className.includes(\"input_error\")) {\r\n          this.props.className = `${this.props.className || \"\"} input_error`;\r\n          this.props.error = INPUT_ERRORS[this.props.attributes.name];\r\n        }\r\n        inputIsValid = false;\r\n      } else {\r\n        if(this.props.className) {\r\n          this.props.className = this.props.className.replace(\" input_error\", \"\");\r\n        }\r\n      }\r\n    }\r\n\r\n    return inputIsValid;\r\n  }\r\n\r\n  init() {\r\n    const blurEvent: (e: InputEvent) => void = (event: InputEvent) => {\r\n      if (event.target && (event.target as Element).nodeName === \"INPUT\") {\r\n        this.value = (event.target as HTMLInputElement).value;\r\n        this.props.attributes.value = this.value;\r\n      }\r\n      this.validation();\r\n    };\r\n    const clickEvent = (event: MouseEvent) => {\r\n      const target = event.target as Element;\r\n      if (target && (target.classList.contains(\"input__eye\") || target.closest(\".input__eye\"))) {\r\n        const input = this.element.querySelector(\".input__el\") as HTMLInputElement;\r\n        input.type = input.type === \"password\" ? \"text\" : \"password\";\r\n      }\r\n    };\r\n\r\n    this.props.events = this.props.events || {};\r\n    if (this.props.events.change) {\r\n      this.props.events.change = Array.isArray(this.props.events.change) ? [...this.props.events.change, blurEvent] : [this.props.events.change, blurEvent];\r\n    } else {\r\n      this.props.events.change = blurEvent;\r\n    }\r\n\r\n    if (this.props.events.click) {\r\n      this.props.events.click = Array.isArray(this.props.events.click) ? [...this.props.events.click, clickEvent] : [this.props.events.click, clickEvent];\r\n    } else {\r\n      this.props.events.click = clickEvent;\r\n    }\r\n  }\r\n\r\n  componentUpdated(): void {\r\n    if (this.value && this.element) {\r\n      const input: HTMLInputElement | null = this.element.querySelector(\".input__el\");\r\n      if (input) {\r\n        input.value = this.value;\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return this.compile(template, this.props);\r\n  }\r\n}\r\n\r\nexport { Input as default, InputProps };\r\n","form.form(class=isModal ? 'form_modal' : '' class=className id=id)\r\n\tif isModal \r\n\t\tbutton.form__close(type=\"button\")\r\n\tif title\r\n\t\tp.form__title= title\r\n\t.auth-form__inputs\r\n\t\t| !{inputs}\r\n\t\t.auth-form__btns \r\n\t\t\t| !{ActionBtn}\r\n\t\t\t|\t!{Link}\r\n\tp.form__error !{error}\r\n","import template from \"./template.pug\";\r\nimport Block from \"../Block/Block\";\r\nimport Input from \"../Input/Input\";\r\n\r\ntype FormProps = {\r\n  title?: string;\r\n  isModal?: boolean;\r\n  inputs?: Block[];\r\n  ActionBtn?: Block;\r\n  events?: Record<string, unknown>;\r\n  [key: string]: any;\r\n};\r\n\r\n\r\nclass Form extends Block {\r\n  isValid: boolean;\r\n\r\n  constructor(props: FormProps) {\r\n    super(props);\r\n  }\r\n\r\n  validation(): boolean {\r\n    this.isValid = true;\r\n    const inputs = Array.isArray(this.children.inputs) ? [...this.children.inputs] : [this.children.inputs];\r\n    inputs.forEach((input: Input) => {\r\n      if(!input.validation()) {\r\n        this.isValid = false;\r\n      }\r\n    });\r\n\r\n    return this.isValid;\r\n  }\r\n\r\n  render(): DocumentFragment {\r\n    return this.compile(template, this.props);\r\n  }\r\n}\r\n\r\nexport default Form;\r\n","if href\r\n\ta.btn(href=href)&attributes(attributes)= text\r\nelse\r\n\tbutton.btn&attributes(attributes)= text\r\n","import template from './template.pug';\r\nimport Block from \"../Block/Block\";\r\n\r\ntype ButtonProps = {\r\n\ttext: string,\r\n\thref?: string,\r\n\tattributes?: any\r\n}\r\n\r\nclass Button extends Block {\r\n\r\n\tconstructor(props: ButtonProps) {\r\n\t\tsuper(props);\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn this.compile(template, this.props);\r\n\t}\r\n}\r\n\r\nexport default Button;\r\n","function escapeHtml(unsafe: unknown): string {\r\n  return `${unsafe}`.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/\"/g, \"&quot;\").replace(/'/g, \"&#039;\");\r\n}\r\n\r\nfunction getFormData(data: FormData): Record<string, unknown> {\r\n  const returnObj: Record<string, unknown> = {};\r\n  data.forEach(function (value, key) {\r\n    returnObj[key] = escapeHtml(value);\r\n  });\r\n\r\n  return returnObj;\r\n}\r\n\r\nfunction dataToJSON(data: Record<string, unknown>): string {\r\n  return JSON.stringify(data);\r\n}\r\n\r\nexport { getFormData, dataToJSON };\r\n","type Indexed<T = unknown> = {\r\n  [key in string]: T;\r\n};\r\n\r\n\r\nfunction merge(lhs: Indexed, rhs: Indexed): Indexed {\r\n  for (const p in rhs) {\r\n      if (!(p in rhs)) {\r\n          continue;\r\n      }\r\n\r\n      try {\r\n          if (rhs[p]?.constructor === Object) {\r\n              rhs[p] = merge(lhs[p] as Indexed, rhs[p] as Indexed);\r\n          } else {\r\n              lhs[p] = rhs[p];\r\n          }\r\n      } catch(e) {\r\n          lhs[p] = rhs[p];\r\n      }\r\n  }\r\n\r\n  return lhs;\r\n}\r\n\r\nexport default merge;\r\n","type Indexed<T = unknown> = {\r\n  [key in string]: T;\r\n};\r\n\r\nimport merge from \"./merge\";\r\n\r\nfunction set(object: Indexed | unknown, path: string, value: unknown): Indexed | unknown {\r\n  if (typeof object !== 'object' || object === null) {\r\n      return object;\r\n  }\r\n\r\n  if (typeof path !== 'string') {\r\n      throw new Error('path must be string');\r\n  }\r\n\r\n  const result = path.split('.').reduceRight<Indexed>((acc, key) => ({\r\n      [key]: acc,\r\n  }), value as any);\r\n  return merge(object as Indexed, result);\r\n}\r\n\r\nexport default set;\r\n","import Block from \"../../components/Block/Block\";\r\nimport EventBus from \"../../components/EventBus/EventBus\";\r\nimport set from \"../../utils/set\";\r\n\r\ntype Indexed = Record<string, unknown>;\r\n\r\nexport enum StoreEvents {\r\n  Updated = \"store:updated\",\r\n}\r\n\r\nclass Store extends EventBus {\r\n  private state: Indexed = {};\r\n\r\n  public getState() {\r\n    return this.state;\r\n  }\r\n\r\n  public set(path: string, value: unknown) {\r\n    set(this.state, path, value);\r\n\r\n    try {\r\n      this.emit(StoreEvents[\"Updated\"], path, value);\r\n    } catch (err) {\r\n      // err\r\n    }\r\n  }\r\n}\r\n\r\nconst store = new Store();\r\n\r\nexport function connect(Component: typeof Block, mapStateToProps: (state: Indexed) => Indexed) {\r\n  let lastComponentState = {};\r\n\r\n  return class extends Component {\r\n    constructor(props: any) {\r\n      const componentProps = { ...props, ...mapStateToProps(store.getState()) };\r\n      super(componentProps);\r\n\r\n      lastComponentState = { ...mapStateToProps(store.getState()) };\r\n\r\n      store.on(StoreEvents.Updated, () => {\r\n        if (!this.componentDidUpdate(lastComponentState, { ...mapStateToProps(store.getState()) })) {\r\n          return;\r\n        }\r\n\r\n        lastComponentState = { ...mapStateToProps(store.getState()) };\r\n\r\n        this.setProps({ ...mapStateToProps(store.getState()) });\r\n      });\r\n    }\r\n  };\r\n}\r\n\r\nexport default store;\r\n","import { default as Store } from \"../Modules/Store/Store\";\r\nimport { Router } from \"../Modules/Router/Router\";\r\nimport { PAGES } from \"../utils/renderDOM\";\r\n\r\nclass AuthController {\r\n  isAuthed() {\r\n    const isAuthed = !!Store.getState().user;\r\n    return isAuthed;\r\n  }\r\n\r\n  redirectToIndex() {\r\n    Router.go(PAGES.index);\r\n  }\r\n\r\n  redirectToLogin() {\r\n    Router.go(PAGES['auth']);\r\n  }\r\n\r\n  getUser() {\r\n    const user = Store.getState().user;\r\n    return user as Record<string, string>;\r\n  }\r\n}\r\n\r\nexport default AuthController;\r\n","import { getFormData } from \"../../utils/dataPrepare\";\r\nimport AuthController from \"../../Controllers/AuthController\";\r\nimport RegistrationAPI from \"./RegistrationAPI\";\r\n\r\nconst RegistrationAPIEntity = new RegistrationAPI();\r\n\r\nclass RegistrationController extends AuthController {\r\n  async signup(data: FormData) {\r\n    const registrationData = getFormData(data);\r\n    const response = await RegistrationAPIEntity.signup(registrationData);\r\n    if (response.status === 200) {\r\n      this.getUser();\r\n      return this.redirectToIndex();\r\n    } else {\r\n      return { error: response.response?.reason };\r\n    }\r\n  }\r\n}\r\n\r\nexport default RegistrationController;\r\n","import AuthAPI from \"../../API/AuthAPI\";\r\nimport { dataToJSON } from \"../../utils/dataPrepare\";\r\n\r\nclass RegistrationAPI extends AuthAPI {\r\n  signup(registrationData: Record<string, unknown>) {\r\n    return this.HTTPEntity.post(\"/signup\", {\r\n      data: dataToJSON(registrationData),\r\n      headers: {\r\n        \"Content-type\": \"application/json; charset=UTF-8\",\r\n      },\r\n    });\r\n  }\r\n}\r\n\r\nexport default RegistrationAPI;\r\n","import template from \"./template.pug\";\r\nimport Block from \"../../components/Block/Block\";\r\nimport { PAGES } from \"../../utils/renderDOM\";\r\nimport Input from \"../../components/Input/Input\";\r\nimport Form from \"../../components/Form/Form\";\r\nimport Button from \"../../components/Button/Button\";\r\nimport RegistrationController from \"./RegistrationController\";\r\n\r\nconst RegistrationControllerEntity = new RegistrationController();\r\n\r\nconst INPUT_CLASS = \"auth-form__input\";\r\n\r\nclass RegistrationPage extends Block {\r\n  init(): void {\r\n    this.children = {\r\n      RegistrationForm: new Form({\r\n        title: \"Регистрация\",\r\n        inputs: [\r\n          new Input({ label: \"Почта\", className: INPUT_CLASS, attributes: { placeholder: \"Почта\", type: \"email\", name: \"email\" } }),\r\n          new Input({ label: \"Логин\", className: INPUT_CLASS, attributes: { placeholder: \"Логин\", name: \"login\" } }),\r\n          new Input({ label: \"Имя\", className: INPUT_CLASS, attributes: { placeholder: \"Имя\", name: \"first_name\" } }),\r\n          new Input({ label: \"Фамилия\", className: INPUT_CLASS, attributes: { placeholder: \"Фамилия\", name: \"second_name\" } }),\r\n          new Input({ label: \"Телефон\", className: INPUT_CLASS, attributes: { placeholder: \"Телефон\", type: \"tel\", name: \"phone\" } }),\r\n          new Input({ label: \"Пароль\", className: INPUT_CLASS, attributes: { placeholder: \"Пароль\", type: \"password\", name: \"password\" } }),\r\n        ],\r\n        ActionBtn: new Button({\r\n          text: \"Зарегистрироваться\",\r\n          attributes: {\r\n            type: \"submit\",\r\n          },\r\n        }),\r\n        Link: `<a class=\"auth-form__register\" href=\"${PAGES.auth}\">Войти</a>`,\r\n        events: {\r\n          submit: async (event: SubmitEvent) => {\r\n            event.preventDefault();\r\n            const currentForm = this.children.RegistrationForm as Form;\r\n            if (currentForm.validation()) {\r\n              const data = new FormData(event.target as HTMLFormElement);\r\n              const response = await RegistrationControllerEntity.signup(data);\r\n\r\n              currentForm.props.error = \"\";\r\n              if (response && response.error) {\r\n                currentForm.props.error = response.error;\r\n              }\r\n            }\r\n          },\r\n        },\r\n      }),\r\n    };\r\n  }\r\n\r\n  render() {\r\n    return this.compile(template, this.props);\r\n  }\r\n\r\n  componentDidMount(): void {\r\n    if (RegistrationControllerEntity.isAuthed()) {\r\n      RegistrationControllerEntity.redirectToIndex();\r\n    }\r\n  }\r\n}\r\n\r\nexport default RegistrationPage;\r\n",".auth-page\r\n\t.auth-page__content \r\n\t\t| !{ AuthForm }\r\n","import { default as Store } from \"../../Modules/Store/Store\";\r\nimport { Router } from \"../../Modules/Router/Router\";\r\nimport { getFormData } from \"../../utils/dataPrepare\";\r\nimport { PAGES } from \"../../utils/renderDOM\";\r\nimport AuthPageAPI from \"./AuthPageAPI\";\r\nimport globalAuthController from \"../../Controllers/AuthController\";\r\n\r\nconst AuthAPIEntity = new AuthPageAPI();\r\n\r\nclass AuthController extends globalAuthController {\r\n  async signin(data: FormData) {\r\n    const { login, password } = getFormData(data);\r\n    if (login && password) {\r\n      const { status, response } = await AuthAPIEntity.signin(login.toString(), password.toString());\r\n      if (status === 200) {\r\n        AuthAPIEntity.getUser().then(user => {\r\n          Store.set(\"user\", {...user});\r\n          this.redirectToIndex();\r\n        })\r\n      } else {\r\n        return { error: response?.reason };\r\n      }\r\n    }\r\n  }\r\n\r\n  async logout() {\r\n    const { status, response } = await AuthAPIEntity.logout();\r\n\r\n    if (status !== 200) {\r\n      return response?.reason;\r\n    }\r\n    Store.set(\"user\", undefined);\r\n    Router.go(PAGES.auth);\r\n  }\r\n}\r\n\r\nexport default AuthController;\r\n","import AuthAPI from \"../../API/AuthAPI\";\r\nimport { dataToJSON } from \"../../utils/dataPrepare\";\r\n\r\nclass AuthPageAPI extends AuthAPI {\r\n  signin(login: string, password: string) {\r\n    return this.HTTPEntity.post(\"/signin\", {\r\n      data: dataToJSON({ login, password }),\r\n      headers: {\r\n        'Content-type': 'application/json; charset=UTF-8'\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nexport default AuthPageAPI;\r\n","import template from \"./template.pug\";\r\nimport Block from \"../../components/Block/Block\";\r\nimport { PAGES } from \"../../utils/renderDOM\";\r\nimport Input from \"../../components/Input/Input\";\r\nimport Form from \"../../components/Form/Form\";\r\nimport Button from \"../../components/Button/Button\";\r\nimport AuthController from \"./AuthController\";\r\n\r\nconst AuthControllerEntity = new AuthController();\r\n\r\nconst INPUT_CLASS = \"auth-form__input\";\r\n\r\nclass AuthPage extends Block {\r\n  init(): void {\r\n    this.children = {\r\n      AuthForm: new Form({\r\n        title: \"Авторизация\",\r\n        inputs: [\r\n          new Input({ label: \"Логин\", className: INPUT_CLASS, attributes: { placeholder: \"Логин\", name: \"login\" } }),\r\n          new Input({ label: \"Пароль\", className: INPUT_CLASS, attributes: { placeholder: \"Пароль\", type: \"password\", name: \"password\" } }),\r\n        ],\r\n        ActionBtn: new Button({\r\n          text: \"Войти\",\r\n          attributes: {\r\n            type: \"submit\",\r\n          },\r\n        }),\r\n        Link: `<a class=\"auth-form__register\" href=\"${PAGES.registration}\">Зарегистрироваться</a>`,\r\n        events: {\r\n          submit: async (event: SubmitEvent) => {\r\n            event.preventDefault();\r\n            const currentForm = this.children.AuthForm as Form;\r\n            if (currentForm.validation()) {\r\n              const data = new FormData(event.target as HTMLFormElement);\r\n              const response = await AuthControllerEntity.signin(data);\r\n\r\n              currentForm.props.error = \"\";\r\n              if (response && response.error) {\r\n                currentForm.props.error = response.error;\r\n              }\r\n            }\r\n          },\r\n        },\r\n      }),\r\n    };\r\n  }\r\n\r\n  render() {\r\n    return this.compile(template, this.props);\r\n  }\r\n\r\n  componentDidMount(): void {\r\n    if(AuthControllerEntity.isAuthed()){\r\n      AuthControllerEntity.redirectToIndex();\r\n    }\r\n  }\r\n}\r\n\r\nexport default AuthPage;\r\n","div\r\n\th1 \"Ссылки\" на страницы\r\n\tnav\r\n\t\tul\r\n\t\t|\t!{links}\r\n","import template from \"./template.pug\";\r\nimport Block from \"../../components/Block/Block\";\r\nimport { PAGES } from \"../../utils/renderDOM\";\r\nimport Button from \"../../components/Button/Button\";\r\n\r\nconst btnStyle = \"margin-bottom: 2rem;\";\r\n\r\nclass PaginationPage extends Block {\r\n  init() {\r\n    this.children = {\r\n      links: [\r\n        new Button({ text: \"Чаты\", href: PAGES.index, attributes: { style: btnStyle } }),\r\n        new Button({ text: \"Авторизация\", href: PAGES.auth, attributes: { style: btnStyle } }),\r\n        new Button({ text: \"Регистрация\", href: PAGES.registration, attributes: { style: btnStyle } }),\r\n        new Button({ text: \"ЛК: Просмотр данных\", href: PAGES.profile, attributes: { style: btnStyle } }),\r\n        new Button({ text: \"ЛК: Редактирование данных\", href: PAGES.profileEdit, attributes: { style: btnStyle } }),\r\n        new Button({ text: \"ЛК: Редактирование пароля\", href: PAGES.changePassword, attributes: { style: btnStyle } }),\r\n        new Button({ text: \"404\", href: PAGES.unknown, attributes: { style: btnStyle } }),\r\n        new Button({ text: \"500\", href: PAGES.serverError, attributes: { style: btnStyle } }),\r\n      ],\r\n    };\r\n  }\r\n\r\n  render() {\r\n    return this.compile(template, this.props);\r\n  }\r\n}\r\n\r\nexport default PaginationPage;\r\n",".profile-page \r\n  a.profile-page__back(href=backUrl)\r\n    include ../../imgs/icons/arrow-back.svg\r\n  .profile-page__content\r\n    | !{Photo}\r\n    p.profile-page__name #{user.first_name}\r\n    .profile-list.profile-page__data\r\n      each val, key in user\r\n        if !(key==='avatar' || key==='id')\r\n          .profile-list__el\r\n            p.profile-list__name #{fieldsNaming[key]}\r\n            | !{val}\r\n    nav.profile-list.profile-page__links\r\n      .profile-list__el\r\n        a(href=changeProfileUrl) Изменить данные\r\n      .profile-list__el\r\n        a(href=changePasswordUrl) Изменить пароль\r\n      .profile-list__el\r\n        a.profile-page__exit#logout Выйти\r\n",".photo(class=canChange ? 'photo_change' : '', class=attributes.class)\r\n  img.photo__img(src=photoSrc, alt=attributes.alt)\r\n  if(canChange)\r\n    | !{ChangePhotoModal}\r\n","form.form.from-image(class=isModal ? 'form_modal' : '' class=attributes.class id=attributes.id enctype=\"multipart/form-data\")\r\n  if isModal \r\n    button.form__close(type=\"button\" data-close=\"true\")\r\n  p.form__title= title\r\n  .auth-form__inputs\r\n    | !{FileInput}\r\n    | !{SaveBtn}\r\n    span.form-image__error= errorText\r\n","label.photo-input(class=attributes.class)\r\n  input.photo-input__input(type=\"file\", name=name, accept=accept)\r\n  if !currentImg\r\n    span.photo-input__title= title \r\n  else\r\n    img.photo-input__img(src=currentImg, alt=name)\r\n    span.photo-input__img-name= imgName \r\n","import template from \"./template.pug\";\r\nimport Block from \"../Block/Block\";\r\n\r\ntype FileInputProps = {\r\n  title: string;\r\n  name: string;\r\n  currentImg?: string;\r\n  imgName?: string;\r\n  accept?: string;\r\n  attributes: {\r\n    class: string;\r\n  };\r\n  events?: any;\r\n};\r\n\r\nclass FileInput extends Block {\r\n  value: File;\r\n\r\n  constructor(props: FileInputProps) {\r\n    if (!props.events) {\r\n      props.events = {};\r\n    }\r\n\r\n    props.events.change = (event: Event) => {\r\n      const input = event.target as HTMLInputElement;\r\n      if (input && input.files) {\r\n        const file = input.files[0];\r\n        this.value = file;\r\n\r\n        if (file.type.startsWith(\"image\")) {\r\n          let fileBase64 = null;\r\n          const reader = new FileReader();\r\n          reader.onload = (e) => {\r\n            fileBase64 = e.target ? e.target.result : null;\r\n            this.setProps({\r\n              imgName: file.name,\r\n              currentImg: fileBase64,\r\n            });\r\n          };\r\n          reader.readAsDataURL(file);\r\n        }\r\n      }\r\n    };\r\n\r\n    super(props);\r\n  }\r\n\r\n  componentDidMount() {\r\n    return true;\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    return true;\r\n  }\r\n\r\n  render() {\r\n    return this.compile(template, this.props);\r\n  }\r\n}\r\n\r\nexport default FileInput;\r\n","import template from \"./template.pug\";\r\nimport Block from \"../Block/Block\";\r\nimport FileInput from \"../FileInput/FileInput\";\r\nimport Button from \"../Button/Button\";\r\n\r\ntype FormFileProps = {\r\n  title: string;\r\n  isModal?: boolean;\r\n  errorText?: string;\r\n  currentImg?: string;\r\n  events?: Record<string, unknown>;\r\n  name?: string;\r\n  accept?: string;\r\n  attributes: {\r\n    class: string;\r\n    id: string;\r\n  };\r\n  [key: string]: any;\r\n};\r\n\r\nclass FormFile extends Block {\r\n  constructor(props: FormFileProps) {\r\n    super(props);\r\n  }\r\n\r\n  init(): void {\r\n    this.children = {\r\n      FileInput: new FileInput({ title: \"Выбрать файл на компьютере\", accept: this.props.accept || '', name: this.props.name || \"avatar\", attributes: { class: \"form-image__input\" } }),\r\n      SaveBtn: new Button({ text: \"Поменять\", attributes: { class: \"form-image__btn\" } }),\r\n    };\r\n  }\r\n\r\n  validation(): boolean {\r\n    if (!(this.children.FileInput as FileInput).value) {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  submit(): void {\r\n    // Переопределение пользователем\r\n  }\r\n\r\n  getFile() {\r\n    return (this.children.FileInput as FileInput).value;\r\n  }\r\n\r\n  render(): DocumentFragment {\r\n    return this.compile(template, this.props);\r\n  }\r\n}\r\n\r\nexport default FormFile;\r\n","import template from \"./template.pug\";\r\nimport Block from \"../Block/Block\";\r\nimport defaultSrc from \"../../utils/defaultPhoto\";\r\nimport FormImage from \"../FormFile/FormFile\";\r\n\r\ntype PhotoProps = {\r\n  photoSrc?: string;\r\n  canChange?: boolean;\r\n  attributes: {\r\n    class?: string;\r\n    alt: string;\r\n  };\r\n  formSubmitCallback?: (data: FormData) => void;\r\n  events?: any;\r\n};\r\n\r\nclass Photo extends Block {\r\n  constructor(props: PhotoProps) {\r\n    super(props);\r\n    if (!this.props.photoSrc) {\r\n      this.props.photoSrc = defaultSrc;\r\n    } else {\r\n      this.props.photoSrc = `https://ya-praktikum.tech/api/v2/resources${this.props.photoSrc}`;\r\n    }\r\n  }\r\n\r\n  init(): void {\r\n    if (this.props.canChange) {\r\n      this.children.ChangePhotoModal = new FormImage({\r\n        title: \"Изменить аватар\",\r\n        isModal: true,\r\n        currentImg: this.props.photoSrc,\r\n        accept: \"image/*\",\r\n        attributes: { class: \"\", id: \"\" },\r\n        events: {\r\n          submit: (event: Event) => {\r\n            event.stopPropagation();\r\n            event.preventDefault();\r\n            const ModalEl = this.children.ChangePhotoModal as FormImage;\r\n            ModalEl.props.attributes.class = \"is-active\";\r\n            if (ModalEl.validation()) {\r\n              const formData = new FormData();\r\n              formData.append(\"avatar\", ModalEl.getFile());\r\n              this.props.formSubmitCallback(formData);\r\n              ModalEl.props.errorText = \"\";\r\n              ModalEl.element.classList.toggle(\"is-active\");\r\n            } else {\r\n              ModalEl.props.errorText = \"Нужно выбрать файл\";\r\n            }\r\n          },\r\n          click: (event: Event) => {\r\n            event.stopPropagation();\r\n            const target = event.target as HTMLElement;\r\n            if (target && target?.classList.contains(\"form__close\")) {\r\n              const ModalEl = this.children.ChangePhotoModal as FormImage;\r\n              ModalEl.element.classList.toggle(\"is-active\");\r\n            }\r\n          },\r\n        },\r\n      });\r\n\r\n      if (!this.props.events) {\r\n        this.props.events = {};\r\n      }\r\n\r\n      this.props.events.click = () => {\r\n        const ModalEl = this.children.ChangePhotoModal as FormImage;\r\n        ModalEl.element.classList.toggle(\"is-active\");\r\n      };\r\n    }\r\n  }\r\n\r\n  render(): DocumentFragment {\r\n    return this.compile(template, this.props);\r\n  }\r\n}\r\n\r\nexport default Photo;\r\n","export default `data:image/svg+xml;base64,PCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KDTwhLS0gVXBsb2FkZWQgdG86IFNWRyBSZXBvLCB3d3cuc3ZncmVwby5jb20sIFRyYW5zZm9ybWVkIGJ5OiBTVkcgUmVwbyBNaXhlciBUb29scyAtLT4KPHN2ZyB3aWR0aD0iODAwcHgiIGhlaWdodD0iODAwcHgiIHZpZXdCb3g9Ii0zIDAgMzIgMzIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgZmlsbD0iIzAwMDAwMCI+Cg08ZyBpZD0iU1ZHUmVwb19iZ0NhcnJpZXIiIHN0cm9rZS13aWR0aD0iMCIvPgoNPGcgaWQ9IlNWR1JlcG9fdHJhY2VyQ2FycmllciIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+Cg08ZyBpZD0iU1ZHUmVwb19pY29uQ2FycmllciI+IDxnIGlkPSJpY29tb29uLWlnbm9yZSI+IDwvZz4gPHBhdGggZD0iTTEyLjggMy4yYy03LjA5MyAwLTEyLjggNS43MDctMTIuOCAxMi44czUuNzA3IDEyLjggMTIuOCAxMi44YzcuMDkzIDAgMTIuOC01LjcwNyAxMi44LTEyLjhzLTUuNzA3LTEyLjgtMTIuOC0xMi44ek0xMi44IDI3LjczM2MtNi40NTMgMC0xMS43MzMtNS4yOC0xMS43MzMtMTEuNzMzczUuMjgtMTEuNzMzIDExLjczMy0xMS43MzNjNi40NTMgMCAxMS43MzMgNS4yOCAxMS43MzMgMTEuNzMzcy01LjI4IDExLjczMy0xMS43MzMgMTEuNzMzeiIgZmlsbD0iIzMzNjlGMyI+IDwvcGF0aD4gPHBhdGggZD0iTTE5LjQ2NyAxOS4wNDBjLTAuMjY3LTAuMTA3LTAuNTg3LTAuMDUzLTAuNjkzIDAuMjEzLTEuMTczIDIuMjkzLTMuNDY3IDMuNjgtNS45NzMgMy42OC0yLjU2IDAtNC44LTEuMzg3LTUuOTczLTMuNjgtMC4xMDctMC4yNjctMC40MjctMC4zNzMtMC42OTMtMC4yMTMtMC4yNjcgMC4xMDctMC4zNzMgMC40MjctMC4yNjcgMC42OTMgMS4zMzMgMi42MTMgMy45NDcgNC4yNjcgNi45MzMgNC4yNjcgMi45MzMgMCA1LjYtMS42NTMgNi44OC00LjI2NyAwLjE2LTAuMjY3IDAuMDUzLTAuNTg3LTAuMjEzLTAuNjkzeiIgZmlsbD0iIzMzNjlGMyI+IDwvcGF0aD4gPHBhdGggZD0iTTEwLjEzMyAxMy4zMzNjMCAwLjg4NC0wLjcxNiAxLjYtMS42IDEuNnMtMS42LTAuNzE2LTEuNi0xLjZjMC0wLjg4NCAwLjcxNi0xLjYgMS42LTEuNnMxLjYgMC43MTYgMS42IDEuNnoiIGZpbGw9IiMzMzY5RjMiPiA8L3BhdGg+IDxwYXRoIGQ9Ik0xOC42NjcgMTMuMzMzYzAgMC44ODQtMC43MTYgMS42LTEuNiAxLjZzLTEuNi0wLjcxNi0xLjYtMS42YzAtMC44ODQgMC43MTYtMS42IDEuNi0xLjZzMS42IDAuNzE2IDEuNiAxLjZ6IiBmaWxsPSIjMzM2OUYzIj4gPC9wYXRoPiA8L2c+Cg08L3N2Zz4=`;\r\n","class ErrorHandler {\r\n  \r\n  constructor(public message: string, public title?:string) {}\r\n\r\n  show() {\r\n    console.log(this.message);\r\n  }\r\n}\r\n\r\nexport default ErrorHandler;\r\n","import AuthAPI from \"../../API/AuthAPI\"\r\n\r\nclass ProfileAPI extends AuthAPI {\r\n\tlogout() {\r\n\t\treturn super.logout();\r\n\t}\r\n}\r\n\r\nexport default new ProfileAPI();\r\n","import ErrorHandler from \"../../components/ErrorHandler/ErrorHandler\";\r\nimport { Router } from \"../../Modules/Router/Router\";\r\nimport Store from \"../../Modules/Store/Store\";\r\nimport { PAGES } from \"../../utils/renderDOM\";\r\nimport ProfileAPI from \"./ProfileAPI\";\r\n\r\nclass ProfileController {\r\n\tasync logout() {\r\n\t\tconst { status, response } = await ProfileAPI.logout();\r\n\t\tif(status === 200) {\r\n\t\t\tStore.set('user', undefined);\r\n      setTimeout(() => {\r\n        Router.go(PAGES['auth']);\r\n      });\r\n\t\t} else {\r\n      if(response) {\r\n        new ErrorHandler(response.toString()).show();\r\n      }\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default new ProfileController();\r\n","import template from \"./template.pug\";\r\nimport { fieldsNaming } from \"../../utils/projectVariables\";\r\nimport Block from \"../../components/Block/Block\";\r\nimport Photo from \"../../components/Photo/Photo\";\r\nimport ProfileController from \"./ProfileController\";\r\nimport { connect } from \"../../Modules/Store/Store\";\r\nimport { PAGES } from \"../../utils/renderDOM\";\r\nimport deepEqual from \"../../utils/deepEqual\";\r\n\r\ntype ProfileProps = {\r\n  user?: Record<string, string | null>;\r\n  userData?: string;\r\n  backUrl?: string;\r\n  changeProfileUrl?: string;\r\n  changePasswordUrl?: string;\r\n  fieldsNaming?: Record<string, string>;\r\n};\r\n\r\nclass ProfilePage extends Block {\r\n  constructor(props?: ProfileProps) {\r\n    if (!props) {\r\n      props = {};\r\n    }\r\n    props.fieldsNaming = fieldsNaming;\r\n\r\n    super(props);\r\n  }\r\n\r\n  init() {\r\n    this.props.backUrl = PAGES[\"index\"];\r\n    this.props.changeProfileUrl = PAGES[\"profileEdit\"];\r\n    this.props.changePasswordUrl = PAGES[\"changePassword\"];\r\n\r\n    this.children = {\r\n      Photo: new Photo({\r\n        photoSrc: this.props.user?.avatar || null,\r\n        attributes: {\r\n          alt: this.props.user?.first_name || \"\",\r\n        },\r\n      }),\r\n    };\r\n\r\n    this.props.events = {\r\n      click: (event: Event) => {\r\n        event.preventDefault();\r\n        const eTarget = event.target as HTMLElement | null;\r\n        if (eTarget && eTarget?.id === \"logout\") {\r\n          ProfileController.logout();\r\n        }\r\n      },\r\n    };\r\n  }\r\n\r\n  componentDidUpdate(oldProps?: unknown, newProps?: unknown): boolean {\r\n    if(deepEqual(oldProps as Record<string, any>, newProps as Record<string, any>)) {\r\n      return false;\r\n    }\r\n\r\n    if(this.children.Photo && this.props.user?.avatar) {\r\n      (this.children.Photo as Photo).props.photoSrc = `https://ya-praktikum.tech/api/v2/resources${this.props.user?.avatar}`;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  render() {\r\n    return this.compile(template, this.props);\r\n  }\r\n}\r\n\r\nexport default connect(ProfilePage, (state) => {\r\n  return { user: { ...state.user! } };\r\n});\r\n",".profile-page \r\n\ta.profile-page__back(href=backUrl)\r\n\t\tinclude ../../imgs/icons/arrow-back.svg\r\n\t.profile-page__content\r\n\t\t| !{Photo}\r\n\t\tp.profile-page__name #{user.first_name}\r\n\t\t| !{ EditForm }\r\n","import BaseAPI from \"./BaseAPI\";\r\n\r\nexport default class ProfileAPI extends BaseAPI {\r\n  constructor() {\r\n    super('/user');\r\n  }\r\n}\r\n","import { Router } from \"../../Modules/Router/Router\";\r\nimport Store from \"../../Modules/Store/Store\";\r\nimport { getFormData } from \"../../utils/dataPrepare\";\r\nimport { PAGES } from \"../../utils/renderDOM\";\r\nimport ProfileEditAPI from \"./ProfileEditAPI\";\r\n\r\nconst ProfileEditAPIEntity = new ProfileEditAPI();\r\n\r\nclass ProfileEditController {\r\n  async changeData(data: FormData) {\r\n    const userData = getFormData(data);\r\n    const { status, response } = await ProfileEditAPIEntity.changeUser(userData);\r\n      if (status === 200) {\r\n        Store.set('user', response);\r\n        Router.go(PAGES['profile']);\r\n      } else {\r\n        return { error: response?.reason };\r\n      }\r\n  }\r\n  async changeAvatar(data: FormData) {\r\n    const { status, response } = await ProfileEditAPIEntity.changePhoto(data);\r\n      if (status === 200) {\r\n        Store.set('user', response);\r\n        Router.go(PAGES['profile']);\r\n      } else {\r\n        return { error: response?.reason };\r\n      }\r\n  }\r\n}\r\n\r\nexport default ProfileEditController;\r\n","import ProfileAPI from \"../../API/ProfileAPI\";\r\nimport { dataToJSON } from \"../../utils/dataPrepare\";\r\n\r\nclass ProfileEditAPI extends ProfileAPI {\r\n  changeUser(data: Record<string, unknown>) {\r\n    return this.HTTPEntity.put(\"/profile\", {\r\n      data: dataToJSON(data),\r\n      headers: {\r\n        \"Content-type\": \"application/json; charset=UTF-8\",\r\n      },\r\n    });\r\n  }\r\n  changePhoto(data: FormData) {\r\n    return this.HTTPEntity.put(\"/profile/avatar\", {\r\n      data\r\n    });\r\n  }\r\n}\r\n\r\nexport default ProfileEditAPI;\r\n","import template from \"./template.pug\";\r\nimport { fieldsNaming } from \"../../utils/projectVariables\";\r\nimport Block from \"../../components/Block/Block\";\r\nimport Photo from \"../../components/Photo/Photo\";\r\nimport Button from \"../../components/Button/Button\";\r\nimport Form from \"../../components/Form/Form\";\r\nimport Input from \"../../components/Input/Input\";\r\nimport AuthController from \"../authentication/AuthController\";\r\nimport ProfileEditController from \"./ProfileEditController\";\r\nimport deepEqual from \"../../utils/deepEqual\";\r\nimport { PAGES } from \"../../utils/renderDOM\";\r\nimport { connect } from \"../../Modules/Store/Store\";\r\n\r\nconst AuthControllerEntity = new AuthController();\r\nconst ProfileEditControllerE = new ProfileEditController();\r\n\r\ntype ProfileEditProps = {\r\n  user?: Record<string, string | null>;\r\n  backUrl?: string;\r\n  fieldsNaming?: Record<string, string>;\r\n  events?: any;\r\n};\r\n\r\nconst INPUT_CLASS = \"auth-form__input\";\r\n\r\nlet userMapping = (state: Record<string, unknown>) => {\r\n  return {\r\n    user: { ...state.user! },\r\n  };\r\n};\r\n\r\nclass ProfileEditPage extends Block {\r\n  constructor(props?: ProfileEditProps) {\r\n    if (!props) {\r\n      props = {};\r\n    }\r\n    props.fieldsNaming = fieldsNaming;\r\n\r\n    super(props);\r\n  }\r\n\r\n  init() {\r\n    this.props.backUrl = PAGES[\"profile\"];\r\n\r\n    this.children = {\r\n      Photo: new Photo({\r\n        photoSrc: this.props.user?.avatar || null,\r\n        canChange: true,\r\n        attributes: {\r\n          alt: this.props.user?.first_name || \"\",\r\n        },\r\n        formSubmitCallback: (data) => {\r\n          ProfileEditControllerE.changeAvatar(data);\r\n        },\r\n      }),\r\n      EditForm: new Form({\r\n        inputs: [\r\n          new Input({\r\n            label: \"Почта\",\r\n            className: INPUT_CLASS,\r\n            attributes: { value: this.props.user.email, placeholder: \"Почта\", type: \"email\", name: \"email\" },\r\n          }),\r\n          new Input({ label: \"Логин\", className: INPUT_CLASS, attributes: { value: this.props.user.login, placeholder: \"Логин\", name: \"login\" } }),\r\n          new Input({ label: \"Имя\", className: INPUT_CLASS, attributes: { value: this.props.user.first_name, placeholder: \"Имя\", name: \"first_name\" } }),\r\n          new Input({\r\n            label: \"Имя в чате\",\r\n            className: INPUT_CLASS,\r\n            attributes: { value: this.props.user.display_name, placeholder: \"Имя\", name: \"display_name\" },\r\n          }),\r\n          new Input({\r\n            label: \"Фамилия\",\r\n            className: INPUT_CLASS,\r\n            attributes: { value: this.props.user.second_name, placeholder: \"Фамилия\", name: \"second_name\" },\r\n          }),\r\n          new Input({\r\n            label: \"Телефон\",\r\n            className: INPUT_CLASS,\r\n            attributes: { value: this.props.user.phone, placeholder: \"Телефон\", type: \"tel\", name: \"phone\" },\r\n          }),\r\n        ],\r\n        ActionBtn: new Button({\r\n          text: \"Изменить\",\r\n          attributes: {\r\n            type: \"submit\",\r\n          },\r\n        }),\r\n        Link: ``,\r\n        events: {\r\n          submit: async (event: SubmitEvent) => {\r\n            event.preventDefault();\r\n            const currentForm = this.children.EditForm as Form;\r\n            if (currentForm.validation()) {\r\n              const formData = new FormData(event.target as HTMLFormElement);\r\n              const response = await ProfileEditControllerE.changeData(formData);\r\n\r\n              currentForm.props.error = \"\";\r\n              if (response && response.error) {\r\n                currentForm.props.error = response.error;\r\n              }\r\n            }\r\n          },\r\n        },\r\n      }),\r\n      SaveBtn: new Button({ text: \"Сохранить\", attributes: { class: \"profile-page__btn-save\", type: \"submit\" } }),\r\n    };\r\n  }\r\n\r\n  render() {\r\n    return this.compile(template, this.props);\r\n  }\r\n\r\n  componentDidMount(): void {\r\n    if (!AuthControllerEntity.isAuthed()) {\r\n      AuthControllerEntity.redirectToLogin();\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(oldProps?: unknown, newProps?: unknown): boolean {\r\n    if(deepEqual(oldProps as Record<string, any>, newProps as Record<string, any>)) {\r\n      return false;\r\n    }\r\n\r\n    if(this.children.Photo && this.props.user?.avatar) {\r\n      (this.children.Photo as Photo).props.photoSrc = `https://ya-praktikum.tech/api/v2/resources${this.props.user?.avatar}`;\r\n    }\r\n    return true;\r\n  }\r\n}\r\n\r\nexport default connect(ProfileEditPage, userMapping);\r\n",".profile-page \r\n  a.profile-page__back(href=backUrl)\r\n    include ../../imgs/icons/arrow-back.svg\r\n  .profile-page__content\r\n    | !{Photo}\r\n    form.profile-list.profile-page__data\r\n      .profile-list__el\r\n        p.profile-list__name Старый пароль\r\n        input.profile-list__input(value=\"\" name='oldPassword' type='password' placeholder=\"Старый пароль\")\r\n      .profile-list__el\r\n        p.profile-list__name Новый пароль\r\n        input.profile-list__input(value=\"\" name='newPassword' type='password' placeholder=\"Новый пароль\")\r\n      .profile-list__el\r\n        p.profile-list__name Подтверждение пароль\r\n        input.profile-list__input(value=\"\" name='confirmPassword' type='password' placeholder=\"Подтверждение пароля\")\r\n      | !{SaveBtn}\r\n","import BaseAPI from \"../../API/BaseAPI\";\r\nimport { dataToJSON } from \"../../utils/dataPrepare\";\r\n\r\nclass ChangePasswordAPI extends BaseAPI {\r\n  changePassword(data: Record<string, unknown>) {\r\n    return this.HTTPEntity.put(\"/password\", {\r\n      data: dataToJSON(data),\r\n      headers: {\r\n        \"Content-type\": \"application/json; charset=UTF-8\",\r\n      },\r\n    });\r\n  }\r\n}\r\n\r\nexport default new ChangePasswordAPI('/user');\r\n","import ErrorHandler from \"../../components/ErrorHandler/ErrorHandler\";\r\nimport { Router } from \"../../Modules/Router/Router\";\r\nimport { getFormData } from \"../../utils/dataPrepare\";\r\nimport { PAGES } from \"../../utils/renderDOM\";\r\nimport ChangePasswordAPI from \"./ChangePasswordAPI\";\r\n\r\n\r\nclass ChangePasswordController {\r\n\tasync changePassword(data: FormData) {\r\n    const { status, response } = await ChangePasswordAPI.changePassword(getFormData(data));\r\n\t\tif(status === 200) {\r\n      setTimeout(() => {\r\n        Router.go(PAGES['profile']);\r\n      });\r\n\t\t} else {\r\n      if(response) {\r\n        if(response.reason)\r\n          new ErrorHandler(response.reason.toString()).show();\r\n      }\r\n\t\t}\r\n  }\r\n}\r\n\r\nexport default new ChangePasswordController();\r\n","import template from \"./template.pug\";\r\nimport { INPUT_VALIDATION_REGEXP } from \"../../utils/projectVariables\";\r\nimport Block from \"../../components/Block/Block\";\r\nimport Photo from \"../../components/Photo/Photo\";\r\nimport Button from \"../../components/Button/Button\";\r\nimport AuthController from \"../authentication/AuthController\";\r\nimport { PAGES } from \"../../utils/renderDOM\";\r\nimport { connect } from \"../../Modules/Store/Store\";\r\nimport ChangePasswordController from \"./ChangePasswordController\";\r\n\r\nconst AuthControllerEntity = new AuthController();\r\n\r\ntype ChangePasswordProps = {\r\n  user?: Record<string, string | null>;\r\n  userData?: string;\r\n  backUrl: string;\r\n  fieldsNaming?: Record<string, string>;\r\n  events?: any;\r\n};\r\n\r\nclass ChangePasswordPage extends Block {\r\n  constructor(props?: ChangePasswordProps) {\r\n    if (props) {\r\n      props.events = {\r\n        submit: (event: Event) => {\r\n          event.preventDefault();\r\n          const formIsValid = this.validate();\r\n          if (formIsValid && event.target) {\r\n            const formData = new FormData(event.target as HTMLFormElement);\r\n            ChangePasswordController.changePassword(formData);\r\n          }\r\n        },\r\n      };\r\n    }\r\n    super(props);\r\n  }\r\n\r\n  init() {\r\n    this.props.backUrl = PAGES[\"profile\"];\r\n\r\n    this.children = {\r\n      Photo: new Photo({\r\n        photoSrc: this.props.user?.avatar || null,\r\n        canChange: false,\r\n        attributes: {\r\n          alt: this.props.user?.first_name || \"\",\r\n        },\r\n      }),\r\n      SaveBtn: new Button({ text: \"Сохранить\", attributes: { class: \"profile-page__btn-save\", type: \"submit\" } }),\r\n    };\r\n  }\r\n\r\n  validate(): boolean {\r\n    let isValid = true;\r\n    const inputs = this.element.querySelectorAll(\"input[name]\");\r\n    inputs.forEach((input: HTMLInputElement) => {\r\n      const currentType: string = input.type;\r\n      const inputIsValid = `${input.value}`.match(INPUT_VALIDATION_REGEXP[currentType]);\r\n\r\n      if (!inputIsValid) {\r\n        input.parentElement?.classList.add(\"is-error\");\r\n        isValid = false;\r\n      } else {\r\n        input.parentElement?.classList.remove(\"is-error\");\r\n      }\r\n    });\r\n\r\n    const passElement = this.element.querySelector(\"input[name=newPassword]\") as HTMLInputElement;\r\n    const confirmElement = this.element.querySelector(\"input[name=confirmPassword]\") as HTMLInputElement;\r\n\r\n    if (passElement.value !== confirmElement.value) {\r\n      passElement.parentElement?.classList.add(\"is-error\");\r\n      confirmElement.parentElement?.classList.add(\"is-error\");\r\n      isValid = false;\r\n    }\r\n\r\n    return isValid;\r\n  }\r\n\r\n  render() {\r\n    return this.compile(template, this.props);\r\n  }\r\n\r\n  componentDidMount(): void {\r\n    if (!AuthControllerEntity.isAuthed()) {\r\n      AuthControllerEntity.redirectToLogin();\r\n    }\r\n  }\r\n}\r\n\r\nexport default connect(ChangePasswordPage, (state) => {\r\n  return { user: { ...state.user! } };\r\n});\r\n",".chat-wrapper\r\n    .chats-sidebar\r\n      a.chat-profile(href=profileUrl)\r\n        | !{UserPhoto}\r\n        p.chat-profile__name #{user.display_name || user.first_name}\r\n      label.chat-search\r\n        .chat-search__icon\r\n          include ../../imgs/icons/search.svg\r\n        input.chat-search__input(type=\"text\" name=\"search\" placeholder=\"Поиск\")\r\n      .chat-add(data-modal=\"add-chat-modal\")\r\n        .chat-add__icon \r\n          include ../../imgs/icons/plus.svg\r\n        span.chat-add__text Добавить новый чат\r\n      .chats-list \r\n        | !{ChatsList}\r\n    \r\n    if ActiveChat\r\n      | !{ActiveChat}\r\n    else\r\n      .chat \r\n        .chat-inactive \r\n          p.chat-inactive__text Выберите чат чтобы отправить сообщение\r\n    | !{Modals}\r\n",".chat-el(class=(isActive ? 'is-active' : ''))\r\n  | !{UserPhoto}\r\n  .chat-el__content \r\n    span.chat-el__name= title\r\n      if last_message\r\n        span.chat-el__text(class=(isUserMessageLast ? 'chat-el__text_last-user' : ''))= last_message.content || '' \r\n    if last_message\r\n      span.chat-el__time= date\r\n  if messageCount > 0\r\n    span.chat-el__msg-count= messageCount\r\n","import template from \"./template.pug\";\r\nimport Block from \"../Block/Block\";\r\nimport Photo from \"../Photo/Photo\";\r\nimport Store from \"../../Modules/Store/Store\";\r\n\r\ntype ChatElProps = {\r\n  id: number;\r\n  title: string;\r\n  avatar: string;\r\n  isActive?: boolean;\r\n  last_message?: Record<string, unknown>;\r\n  isUserMessageLast?: boolean;\r\n  date?: string;\r\n  messageCount?: number;\r\n  events?: Record<string, () => void>;\r\n};\r\n\r\nfunction dateIsToday(date: Date) {\r\n  const inputDate = new Date(date);\r\n  const todaysDate = new Date();\r\n  if (inputDate.setHours(0, 0, 0, 0) == todaysDate.setHours(0, 0, 0, 0)) {\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\n\r\nclass ChatEl extends Block {\r\n  constructor(props: ChatElProps) {\r\n    if (props.last_message) {\r\n      const messageDate = new Date(`${props.last_message.time}`);\r\n      props.date = dateIsToday(messageDate)\r\n        ? `${messageDate.getHours()}:${messageDate.getMinutes() < 10 ? \"0\" : \"\"}${messageDate.getMinutes()}`\r\n        : `${messageDate.toLocaleString(\"ru\", {\r\n            year: \"numeric\",\r\n            month: \"numeric\",\r\n            day: \"numeric\"\r\n          })}`;\r\n      props.messageCount = Number(props.last_message.unread_message);\r\n      const user = Store.getState().user as Record<string, unknown> | null;\r\n      if (user && user?.id) {\r\n        props.isUserMessageLast = user.display_name === (props.last_message.user as Record<string, unknown>)?.display_name;\r\n      }\r\n    }\r\n    super(props);\r\n  }\r\n\r\n  init(): void {\r\n    this.children = {\r\n      UserPhoto: new Photo({ photoSrc: this.props.avatar, attributes: { class: \"chat-el__img\", alt: this.props.title } }),\r\n    };\r\n  }\r\n\r\n  render() {\r\n    return this.compile(template, this.props);\r\n  }\r\n}\r\n\r\nexport default ChatEl;\r\n",".chat\r\n\t.chat-active \r\n\t\t.chat-user\r\n\t\t\ta.chat-profile.chat-user__profile(href=profileUrl)\r\n\t\t\t\t| !{UserPhoto}\r\n\t\t\t\tp.chat-profile__name= title\r\n\t\t\t.chat-user__menu \r\n\t\t\t\t.chat-user__icon\r\n\t\t\t\t\tinclude ../../imgs/icons/vertical-elipsis.svg\r\n\t\t\t\t.chat-user__actions   \r\n\t\t\t\t\tbutton.chat-user__action(data-modal=\"change-photo-modal\")\r\n\t\t\t\t\t\tspan.chat-user__action-image \r\n\t\t\t\t\t\t\tinclude ../../imgs/icons/image.svg\r\n\t\t\t\t\t\tspan.chat-user__action-text Изменить изображение\r\n\t\t\t\t\tbutton.chat-user__action(data-modal=\"add-user-modal\")\r\n\t\t\t\t\t\tspan.chat-user__action-image \r\n\t\t\t\t\t\t\tinclude ../../imgs/icons/plus.svg\r\n\t\t\t\t\t\tspan.chat-user__action-text Добавить пользователя\r\n\t\t\t\t\tbutton.chat-user__action(data-modal=\"remove-user-modal\")\r\n\t\t\t\t\t\tspan.chat-user__action-image\r\n\t\t\t\t\t\t\tinclude ../../imgs/icons/cross.svg\r\n\t\t\t\t\t\tspan.chat-user__action-text Удалить пользователя\r\n\t\t\t\t\tbutton.chat-user__action.chat-user__action_remove(data-modal=\"confirm-modal\")\r\n\t\t\t\t\t\tspan.chat-user__action-image\r\n\t\t\t\t\t\t\tinclude ../../imgs/icons/remove.svg\r\n\t\t\t\t\t\tspan.chat-user__action-text Удалить чат\r\n\t\t.chat-messages\r\n\t\t\tdiv.chat-messages__row\r\n\t\t\t\t//- span.chat-messages__date  19 июня\r\n\t\t\t| !{Messages}\r\n\r\n\t\t.chat-message\r\n\t\t\t.chat-message__menu \r\n\t\t\t\t//- .chat-message__icon\r\n\t\t\t\t//- \tinclude ../../imgs/icons/clip.svg\r\n\t\t\t\t//- .chat-message__actions   \r\n\t\t\t\t//- \tbutton.chat-message__action(type=\"button\" data-modal=\"add-photo-modal\")\r\n\t\t\t\t//- \t\tspan.chat-message__action-image \r\n\t\t\t\t//- \t\t\tinclude ../../imgs/icons/image.svg\r\n\t\t\t\t//- \t\tspan.chat-message__action-text Фото или видео\r\n\t\t\t\t//- \tbutton.chat-message__action(type=\"button\" data-modal=\"add-file-modal\")\r\n\t\t\t\t//- \t\tspan.chat-message__action-image \r\n\t\t\t\t//- \t\t\tinclude ../../imgs/icons/file.svg\r\n\t\t\t\t//- \t\tspan.chat-message__action-text Файл\r\n\t\t\t| !{MessageFormEl}\r\n\t| !{Modals}\r\n","if isMedia\r\n  .chat-messages__message.chat-messages__media(class=(isIncoming ? \"chat-messages__message_in\" : \"chat-messages__message_out\"))\r\n    span.chat-messages__time= time\r\n    img.chat-messages__img(src=src alt=\"Изображение в чате\")\r\nelse \r\n  div.chat-messages__row\r\n    .chat-messages__message(class=(isIncoming ? \"chat-messages__message_in\" : \"chat-messages__message_out\"))\r\n      span.chat-messages__time= time\r\n      p.chat-messages__text= text\r\n\r\n\r\n\r\n","import template from \"./template.pug\";\r\nimport Block from \"../Block/Block\";\r\n\r\ntype MessageProps = {\r\n  text: string;\r\n  time: string;\r\n  isIncoming?: boolean;\r\n  isMedia?: boolean;\r\n  src?: string;\r\n  events?: any;\r\n};\r\n\r\nclass Message extends Block {\r\n  constructor(props: MessageProps) {\r\n    super(props);\r\n  }\r\n\r\n  render(): DocumentFragment {\r\n    return this.compile(template, this.props);\r\n  }\r\n}\r\n\r\nexport default Message;\r\n","form.form.form_modal(class=className id=id)\r\n\tbutton.form__close(type=\"button\", data-close=\"true\")\r\n\tif title\r\n\t\tp.form__title= title\r\n\t| !{input}\r\n\t| !{Button}\r\n\t| !{content}\r\n","import template from \"./template.pug\";\r\nimport Block from \"../../components/Block/Block\";\r\n\r\ntype SmallFormProps = {\r\n  title: string;\r\n  content?: string;\r\n  input?: Block;\r\n  Button?: Block;\r\n  id?: string;\r\n  events?: any;\r\n};\r\n\r\nclass SmallForm extends Block {\r\n  constructor(props?: SmallFormProps) {\r\n    super(props);\r\n  }\r\n\r\n  getData(event?: Event): FormData | undefined {\r\n    event!.preventDefault();\r\n    if (this.children.input) {\r\n      if (this.children.input) {\r\n        const formData = new FormData(this.element as HTMLFormElement);\r\n        return formData;\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return this.compile(template, this.props);\r\n  }\r\n\r\n  reset() {\r\n    (this.element as HTMLFormElement).reset();\r\n  }\r\n\r\n  show() {\r\n    this.element.classList.add(\"is-active\");\r\n  }\r\n\r\n  hide() {\r\n    this.element.classList.remove(\"is-active\");\r\n  }\r\n}\r\n\r\nexport default SmallForm;\r\n","form.chat-message-form\r\n  input.chat-message__input(name=\"message\")\r\n  button.chat-message__submit(type=\"submit\")\r\n    include ../../imgs/icons/send.svg\r\n","import template from \"./template.pug\";\r\nimport Block from \"../Block/Block\";\r\n\r\ntype MessageFormProps = {\r\n  events?: Record<string, ((event?: Event) => void)>\r\n};\r\n\r\nclass MessageForm extends Block {\r\n  constructor(props?: MessageFormProps) {\r\n    super(props);\r\n  }\r\n\r\n  submit(): void {\r\n    const form = this.element as HTMLFormElement;\r\n    const formData = new FormData(form);\r\n    if(formData.get('message')) {\r\n      this.element.dispatchEvent(new CustomEvent('send-message', {\r\n        detail: formData.get('message'),\r\n        bubbles: true\r\n      }))\r\n      form.reset();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return this.compile(template, this.props);\r\n  }\r\n}\r\n\r\nexport default MessageForm;\r\n","import template from \"./template.pug\";\r\nimport Block from \"../../components/Block/Block\";\r\nimport Photo from \"../Photo/Photo\";\r\nimport Message from \"../Message/Message\";\r\nimport SmallForm from \"../SmallForm/SmallForm\";\r\nimport Button from \"../Button/Button\";\r\nimport Input from \"../Input/Input\";\r\nimport FormFile from \"../FormFile/FormFile\";\r\nimport MessageForm from \"../MessageForm/MessageForm\";\r\nimport store, { connect } from \"../../Modules/Store/Store\";\r\n\r\ntype ActiveChatProps = {\r\n  avatar?: string;\r\n  title?: string;\r\n  id?: number;\r\n  events?: Record<string, (...args: any[]) => void>;\r\n};\r\n\r\nclass ActiveChatPage extends Block {\r\n  constructor(props?: ActiveChatProps) {\r\n    super(props);\r\n  }\r\n\r\n  init() {\r\n    const changePhotoModal = new FormFile({\r\n      isModal: true,\r\n      title: \"Изменить изображение\",\r\n      accept: \"image/*\",\r\n      attributes: { id: \"change-photo-modal\", class: \"\" },\r\n      events: {\r\n        change: () => {\r\n          if (changePhotoModal.validation()) {\r\n            changePhotoModal.props.attributes.class = \"is-active\";\r\n            changePhotoModal.props.title = \"Файл загружен\";\r\n          }\r\n        },\r\n        submit: () => {\r\n          // changePhotoModal.submit(event);\r\n        },\r\n      },\r\n    });\r\n    const addPhotoModal = new FormFile({\r\n      isModal: true,\r\n      title: \"Добавить изображение\",\r\n      name: \"file\",\r\n      accept: \"image/*,video/*\",\r\n      attributes: { id: \"add-photo-modal\", class: \"\" },\r\n      events: {\r\n        change: () => {\r\n          if (addPhotoModal.validation()) {\r\n            addPhotoModal.props.attributes.class = \"is-active\";\r\n            addPhotoModal.props.title = \"Файл загружен\";\r\n          }\r\n        },\r\n        submit: () => {\r\n          // addPhotoModal.submit();\r\n        },\r\n      },\r\n    });\r\n    const addFileModal = new FormFile({\r\n      isModal: true,\r\n      title: \"Добавить файл\",\r\n      attributes: { id: \"add-file-modal\", class: \"\" },\r\n      name: \"file\",\r\n      events: {\r\n        change: () => {\r\n          if (addFileModal.validation()) {\r\n            addFileModal.props.attributes.class = \"is-active\";\r\n            addFileModal.props.title = \"Файл загружен\";\r\n          }\r\n        },\r\n        submit: () => {\r\n          // addFileModal.submit();\r\n        },\r\n      },\r\n    });\r\n    const addUserModal = new SmallForm({\r\n      title: \"Добавить пользователя\",\r\n      id: \"add-user-modal\",\r\n      input: new Input({ label: \"Логин\", attributes: { type: \"text\", name: \"user-login\" } }),\r\n      Button: new Button({ text: \"Добавить\", attributes: { class: \"form-user__btn\" } }),\r\n      events: {\r\n        submit: (event: Event) => {\r\n          const data = addUserModal.getData(event);\r\n          this.element.dispatchEvent(\r\n            new CustomEvent(\"add-user\", {\r\n              detail: data?.get(\"user-login\"),\r\n            })\r\n          );\r\n          addUserModal.reset();\r\n          addUserModal.hide();\r\n        },\r\n      },\r\n    });\r\n    const removeUserModal = new SmallForm({\r\n      title: \"Удалить пользователя\",\r\n      id: \"remove-user-modal\",\r\n      input: new Input({ label: \"Логин\", attributes: { type: \"text\", name: \"user-login\" } }),\r\n      Button: new Button({ text: \"Удалить\", attributes: { class: \"form-user__btn btn_cancel\" } }),\r\n      events: {\r\n        submit: (event: Event) => {\r\n          const data = removeUserModal.getData(event);\r\n          this.element.dispatchEvent(\r\n            new CustomEvent(\"remove-user\", {\r\n              detail: data?.get(\"user-login\"),\r\n            })\r\n          );\r\n          removeUserModal.reset();\r\n          removeUserModal.hide();\r\n        },\r\n      },\r\n    });\r\n    const MessageFormElement = new MessageForm({\r\n      events: {\r\n        submit: (event: Event) => {\r\n          event.preventDefault();\r\n          MessageFormElement.submit();\r\n        },\r\n      },\r\n    });\r\n    const removeChatModal = new SmallForm({\r\n      title: \"Подтвердите действие\",\r\n      id: \"confirm-modal\",\r\n      content: `\r\n    <div class = \"form-confirm__btns\">\r\n      <button class = \"btn btn_cancel form-confirm__btn\">Удалить</button>\r\n      <button class = \"btn form-confirm__btn\">Оставить</button>\r\n    </div>\r\n    `,\r\n      events: {\r\n        click: (event?: Event) => {\r\n          event?.preventDefault();\r\n          const target = event!.target as HTMLElement | null;\r\n          if (target && target.classList.contains(\"btn_cancel\")) {\r\n            this.element.dispatchEvent(new Event(\"remove-chat\"));\r\n            return removeChatModal.hide();\r\n          }\r\n          if (target && target.classList.contains(\"form-confirm__btn\")) {\r\n            removeChatModal.hide();\r\n          }\r\n        },\r\n      },\r\n    });\r\n\r\n    this.children = {\r\n      UserPhoto: new Photo({ photoSrc: this.props.avatar, attributes: { class: \"chat-profile__img\", alt: this.props.title } }),\r\n      Messages: [],\r\n      Modals: [removeChatModal, removeUserModal, addUserModal, changePhotoModal, addPhotoModal, addFileModal],\r\n      MessageFormEl: MessageFormElement,\r\n    };\r\n  }\r\n\r\n  componentDidUpdate(oldProps: any, newProps: any): boolean {\r\n    if (!oldProps.activeChat?.messages || oldProps.activeChat?.messages.length !== newProps.activeChat?.messages.length) {\r\n      this.fillMessages();\r\n      this.element.dispatchEvent(new CustomEvent(\"updated\"));\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  fillMessages() {\r\n    if (this.props.activeChat?.messages) {\r\n      this.children.Messages = [];\r\n      const currentUser = store.getState().user as Record<string, unknown>;\r\n      this.props.activeChat.messages.forEach((message: Record<string, unknown>) => {\r\n        const isCurrentUser = currentUser.id === message.user_id;\r\n        const messageTime = new Date(`${message.time}`);\r\n        const messageBlock = new Message({\r\n          text: `${message.content}`,\r\n          time: `${messageTime.getHours()}:${messageTime.getMinutes() < 10 ? \"0\" : \"\"}${messageTime.getMinutes()}`,\r\n          isIncoming: !isCurrentUser,\r\n        });\r\n        (this.children.Messages as Block[]).push(messageBlock);\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return this.compile(template, this.props);\r\n  }\r\n}\r\n\r\nexport default connect(ActiveChatPage, (state) => {\r\n  return {\r\n    activeChat: { ...state.activeChat! },\r\n  };\r\n});\r\n","import BaseAPI from \"../../API/BaseAPI\";  \r\nimport { dataToJSON } from \"../../utils/dataPrepare\";\r\n\r\nclass ChatsAPI extends BaseAPI {\r\n  getChats() {\r\n    return this.HTTPEntity.get(\"\");\r\n  }\r\n\r\n  addChat(data: Record<string, unknown>) {\r\n    return this.HTTPEntity.post(\"\", {\r\n      data: dataToJSON(data),\r\n      headers: {\r\n        \"Content-type\": \"application/json; charset=UTF-8\",\r\n      },\r\n    });\r\n  }\r\n\r\n  removeChat(id: number) {\r\n    return this.HTTPEntity.delete(\"\", {\r\n      data: dataToJSON({ chatId: id }),\r\n      headers: {\r\n        \"Content-type\": \"application/json; charset=UTF-8\",\r\n      },\r\n    });\r\n  }\r\n\r\n  addUser(chatId: number, userId: number) {\r\n    return this.HTTPEntity.put(\"/users\", {\r\n      data: dataToJSON({ chatId, users: [userId] }),\r\n      headers: {\r\n        'Content-type': 'application/json; charset=UTF-8'\r\n      }\r\n    });\r\n  }\r\n\r\n  removeUser(chatId: number, userId: number) {\r\n    return this.HTTPEntity.delete(\"/users\", {\r\n      data: dataToJSON({ chatId, users: [userId] }),\r\n      headers: {\r\n        'Content-type': 'application/json; charset=UTF-8'\r\n      }\r\n    });\r\n  }\r\n\r\n  getToken(chatId: number) {\r\n    return this.HTTPEntity.post(`/token/${chatId}`);\r\n  }\r\n}\r\n\r\nexport default new ChatsAPI(\"/chats\");\r\n","import { dataToJSON } from \"../utils/dataPrepare\";\r\nimport BaseAPI from \"./BaseAPI\";\r\n\r\nexport type UserType = {\r\n  id: number;\r\n  first_name: string;\r\n  second_name: string;\r\n  display_name: string;\r\n  login: string;\r\n  email: string;\r\n  phone: string;\r\n  avatar: string;\r\n};\r\n\r\nclass UserAPI extends BaseAPI {\r\n  constructor() {\r\n    super(\"/user\");\r\n  }\r\n\r\n  searchByLogin(login: string) {\r\n    return this.HTTPEntity.post(\"/search\", {\r\n      data: dataToJSON({ login }),\r\n      headers: {\r\n        'Content-type': 'application/json; charset=UTF-8'\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nexport default new UserAPI();\r\n","import Store from \"../Modules/Store/Store\";\r\n\r\nclass ChatController {\r\n  private token: string;\r\n  private chatId: number;\r\n  private socket: WebSocket | null;\r\n  private messageAmount: number;\r\n\r\n  constructor(token: string, chatId: number) {\r\n    this.token = token;\r\n    this.chatId = chatId;\r\n    this.messageAmount = 0;\r\n  }\r\n\r\n  connect(): Promise<WebSocket> | null {\r\n    const user = Store.getState().user as Record<string, unknown>;\r\n    if (user && \"id\" in user) {\r\n      return new Promise((resolve) => {\r\n        const socket = new WebSocket(`wss://ya-praktikum.tech/ws/chats/${user.id}/${this.chatId}/${this.token}`);\r\n        socket.addEventListener(\"open\", () => {\r\n          console.log(\"Соединение установлено\");\r\n          this.getOld();\r\n        });\r\n        this.socket = socket;\r\n        this.addEvents();\r\n        this.supportConnecting();\r\n        resolve(socket);\r\n      });\r\n    }\r\n    return null;\r\n  }\r\n\r\n  addEvents() {\r\n    if (this.socket) {\r\n      this.socket.addEventListener(\"close\", this.onClose.bind(this));\r\n      this.socket.addEventListener(\"message\", this.onMessage.bind(this));\r\n      this.socket.addEventListener(\"error\", this.onError.bind(this));\r\n    }\r\n  }\r\n\r\n  supportConnecting() {\r\n    setInterval(() => {\r\n      this.socket?.send(JSON.stringify({\r\n        type: 'ping'\r\n      }))\r\n    }, 10000);\r\n  }\r\n\r\n  onClose(event: CloseEvent) {\r\n    if (event.wasClean) {\r\n      console.log(\"Соединение закрыто чисто\");\r\n    } else {\r\n      console.log(\"Обрыв соединения\");\r\n    }\r\n\r\n    console.log(`Код: ${event.code} | Причина: ${event.reason}`);\r\n  }\r\n\r\n  onMessage(event: MessageEvent) {\r\n    const data = JSON.parse(event.data);\r\n    switch(data?.type) {\r\n      case 'message':\r\n        this.processNewMessage(data);\r\n      break;\r\n      case 'pong':\r\n      break;\r\n      default:\r\n        this.processOldMessages(data);\r\n    }\r\n  }\r\n\r\n  onError(event: ErrorEvent) {\r\n    console.log(\"Ошибка\", event.message);\r\n  }\r\n\r\n  getSocket() {\r\n    return this.socket;\r\n  }\r\n\r\n  sendMessage(message: string) {\r\n    if (this.socket) {\r\n      this.socket.send(\r\n        JSON.stringify({\r\n          content: message,\r\n          type: \"message\",\r\n        })\r\n      );\r\n    }\r\n  }\r\n\r\n  getOld() {\r\n    if(this.socket) {\r\n      this.socket.send(JSON.stringify({\r\n        content: `${this.messageAmount}`,\r\n        type: 'get old',\r\n      }));\r\n    }\r\n  }\r\n\r\n  processOldMessages(messages: any[]) {\r\n    if(messages?.length) {\r\n      const oldMessages = ((Store.getState()?.activeChat as Record<string, unknown>)?.messages as any[]) || [];\r\n      const allMessages = [...oldMessages, ...messages.reverse()];\r\n      Store.set('activeChat.messages', allMessages);\r\n      this.messageAmount += messages.length;\r\n    }\r\n  }\r\n\r\n  processNewMessage(message: Record<string, unknown>) {\r\n    const oldMessages = ((Store.getState()?.activeChat as Record<string, unknown>)?.messages as any[]) || [];\r\n    const allMessages = [...oldMessages, message];\r\n    Store.set('activeChat.messages', allMessages);\r\n    this.messageAmount++;;\r\n  }\r\n}\r\n\r\nexport default ChatController;\r\n","import { getFormData } from \"../../utils/dataPrepare\";\r\nimport { default as Store } from \"../../Modules/Store/Store\";\r\nimport ChatsAPI from \"./ChatsAPI\";\r\nimport { default as UserAPI, UserType } from \"../../API/UserAPI\";\r\nimport ChatAPI from \"../../API/ChatAPI\";\r\nimport escapeHtml from \"../../utils/escape\";\r\n\r\nclass ChatsController {\r\n  private activeChat: ChatAPI;\r\n\r\n  async updateChats() {\r\n    const { response, status } = await ChatsAPI.getChats();\r\n    if (status === 200) {\r\n      Store.set(\"chats\", response);\r\n    } else {\r\n    }\r\n  }\r\n\r\n  async addChat(data: FormData | undefined): Promise<boolean> {\r\n    if (data) {\r\n      const { status } = await ChatsAPI.addChat(getFormData(data));\r\n      if (status === 200) {\r\n        return true;\r\n      } else {\r\n        return false;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  async removeChat(id: number): Promise<boolean> {\r\n    const { status } = await ChatsAPI.removeChat(id);\r\n    if (status === 200) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  async addUser(chatId: number, userLogin: string) {\r\n    const { status, response } = await UserAPI.searchByLogin(userLogin);\r\n    if (status === 200) {\r\n      if (response && Array.isArray(response)) {\r\n        const user = response.shift() as UserType;\r\n        const userId = user.id;\r\n        if (await ChatsAPI.addUser(chatId, userId)) {\r\n          return { error: \"\" };\r\n        }\r\n      }\r\n    } else {\r\n      return { error: \"Ошибка на сервере!\" };\r\n    }\r\n    return { error: \"Пользователь не найден!\" };\r\n  }\r\n\r\n  async removeUser(chatId: number, userLogin: string) {\r\n    const { status, response } = await UserAPI.searchByLogin(userLogin);\r\n    if (status === 200) {\r\n      if (response && Array.isArray(response)) {\r\n        const user = response.shift() as UserType;\r\n        const userId = user.id;\r\n        if (await ChatsAPI.removeUser(chatId, userId)) {\r\n          return { error: \"\" };\r\n        }\r\n      }\r\n    } else {\r\n      return { error: \"Ошибка на сервере!\" };\r\n    }\r\n    return { error: \"Пользователь не найден!\" };\r\n  }\r\n\r\n  async connectToChat(chatId: number) {\r\n    const { status, response } = await ChatsAPI.getToken(chatId);\r\n    if (status === 200 && response) {\r\n      const token = `${response[\"token\"]}`;\r\n      this.activeChat = new ChatAPI(token, chatId);\r\n      this.activeChat.connect();\r\n    }\r\n  }\r\n\r\n  sendMessage(message: string) {\r\n    this.activeChat.sendMessage(escapeHtml(message));\r\n  }\r\n}\r\n\r\nexport default new ChatsController();\r\n","const escapeHtml = (unsafe: string) => {\r\n  return unsafe.replaceAll('&', '&amp;').replaceAll('<', '&lt;').replaceAll('>', '&gt;').replaceAll('\"', '&quot;').replaceAll(\"'\", '&#039;');\r\n}\r\n\r\nexport default escapeHtml;\r\n","import template from \"./template.pug\";\r\nimport Block from \"../../components/Block/Block\";\r\nimport Photo from \"../../components/Photo/Photo\";\r\nimport ChatEl from \"../../components/ChatEl/ChatEl\";\r\nimport ActiveChatPage from \"../../components/ActiveChat/ActiveChat\";\r\nimport SmallForm from \"../../components/SmallForm/SmallForm\";\r\nimport Input from \"../../components/Input/Input\";\r\nimport Button from \"../../components/Button/Button\";\r\nimport AuthController from \"../authentication/AuthController\";\r\nimport { PAGES } from \"../../utils/renderDOM\";\r\nimport { connect } from \"../../Modules/Store/Store\";\r\nimport ChatsController from \"./ChatsController\";\r\nimport ErrorHandler from \"../../components/ErrorHandler/ErrorHandler\";\r\n\r\nconst AuthControllerEntity = new AuthController();\r\n\r\ntype ChatsPageProps = {\r\n  profileUrl: string;\r\n  chats?: ChatEl[];\r\n};\r\n\r\nclass ChatsPage extends Block {\r\n  constructor(props: ChatsPageProps) {\r\n    super(props);\r\n  }\r\n\r\n  async init() {\r\n    this.props.profileUrl = PAGES[\"profile\"];\r\n\r\n    const addChatModal = new SmallForm({\r\n      title: \"Добавить чат\",\r\n      id: \"add-chat-modal\",\r\n      input: new Input({ label: \"Название чата\", attributes: { type: \"text\", name: \"title\" } }),\r\n      Button: new Button({ text: \"Добавить\", attributes: { class: \"form-user__btn\" } }),\r\n      events: {\r\n        submit: async (event: Event) => {\r\n          if (await ChatsController.addChat(addChatModal.getData(event))) {\r\n            addChatModal.reset();\r\n            addChatModal.hide();\r\n            this.updateChats();\r\n          }\r\n        },\r\n      },\r\n    });\r\n\r\n    this.children = {\r\n      UserPhoto: new Photo({ photoSrc: this.props.user.avatar, attributes: { class: \"chat-profile__img\", alt: this.props.user.first_name } }),\r\n      ChatsList: [],\r\n      Modals: [addChatModal],\r\n    };\r\n\r\n    if (!this.props.events) {\r\n      this.props.events = {};\r\n    }\r\n\r\n    this.props.events.click = [\r\n      this.openMenu,\r\n      (event: Event) => {\r\n        let target = event.target as HTMLElement;\r\n        target = target.closest(\"[data-modal]\") || target;\r\n        document.querySelector(`#${target.dataset.modal}`)?.classList.add(\"is-active\");\r\n      },\r\n      (event: Event) => {\r\n        const target = event.target as Element;\r\n        const actionBtn = target.closest(\"[data-close]\");\r\n        if (actionBtn) {\r\n          actionBtn.parentElement?.classList.remove(\"is-active\");\r\n        }\r\n      },\r\n    ];\r\n  }\r\n\r\n  async updateChats() {\r\n    await ChatsController.updateChats();\r\n    this.children.ChatsList = [];\r\n\r\n    for (const key in this.props.chats) {\r\n      const chat = this.props.chats[key];\r\n      this.children.ChatsList.push(\r\n        new ChatEl({\r\n          ...chat,\r\n          isActive: (this.children.ActiveChat as Block)?.props.id === chat.id,\r\n          events: {\r\n            click: this.chooseChat.bind(this, chat),\r\n          },\r\n        })\r\n      );\r\n    }\r\n\r\n    this._render();\r\n  }\r\n\r\n  async chooseChat(chat: Record<string, unknown>, event: Event) {\r\n    let target = event.target as HTMLElement;\r\n    target = target.closest(\".chat-el\") || target;\r\n    if (target.classList.contains(\"is-active\")) {\r\n      return;\r\n    }\r\n    this.element.querySelector(\".chat-el.is-active\")?.classList.remove(\"is-active\");\r\n    target.classList.add(\"is-active\");\r\n    \r\n    await ChatsController.connectToChat(Number(chat.id));\r\n    \r\n    this.children.ActiveChat = new ActiveChatPage({\r\n      ...chat,\r\n      events: {\r\n        \"remove-chat\": async () => {\r\n          if (await ChatsController.removeChat(Number(chat.id))) {\r\n            delete this.children.ActiveChat;\r\n            delete this.props.ActiveChat;\r\n            this.updateChats();\r\n          }\r\n        },\r\n        \"add-user\": async (event: CustomEvent) => {\r\n          const userLogin = event.detail;\r\n          const { error } = await ChatsController.addUser(Number(chat.id), userLogin);\r\n          if (error) {\r\n            return new ErrorHandler(error).show();\r\n          }\r\n        },\r\n        \"remove-user\": async (event: CustomEvent) => {\r\n          const userLogin = event.detail;\r\n          const { error } = await ChatsController.removeUser(Number(chat.id), userLogin);\r\n          if (error) {\r\n            return new ErrorHandler(error).show();\r\n          }\r\n        },\r\n        \"send-message\": (event: CustomEvent) => {\r\n          const message = event.detail;\r\n          ChatsController.sendMessage(message);\r\n        },\r\n        \"updated\": () => {\r\n          this.updateChats();\r\n        }\r\n      },\r\n    });\r\n    this.props.ActiveChat = this.children.ActiveChat;\r\n    this.children.ActiveChat.dispatchComponentDidMount();\r\n  }\r\n\r\n  openMenu(event: Event): void {\r\n    let target = event.target as HTMLElement;\r\n    target = target.closest(\".chat-message__menu\") || target.closest(\".chat-user__menu\") || target;\r\n    if (target.classList.length > 0) {\r\n      const menuBtn = target.querySelector(`.${Array.from(target.classList).join(\".\")} > [class*=actions]`) || null;\r\n      if (menuBtn) {\r\n        menuBtn.classList.toggle(\"is-active\");\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return this.compile(template, this.props);\r\n  }\r\n\r\n  async componentDidMount() {\r\n    if (!AuthControllerEntity.isAuthed()) {\r\n      return AuthControllerEntity.redirectToLogin();\r\n    }\r\n    this.updateChats();\r\n  }\r\n}\r\n\r\nexport default connect(ChatsPage, (state) => {\r\n  return { user: { ...state.user! }, chats: { ...state.chats! } };\r\n});\r\n",".error-page \r\n  p.error-page__status #{status}\r\n  p.error-page__text #{statusText}\r\n  | !{Link}\r\n","import template from \"./template.pug\";\r\nimport Block from \"../../components/Block/Block\";\r\nimport Button from \"../../components/Button/Button\";\r\nimport { PAGES } from \"../../utils/renderDOM\"\r\n\r\ntype ErrorPageProps = {\r\n  status: string | number;\r\n  statusText: string;\r\n};\r\n\r\nclass ErrorPage extends Block {\r\n  constructor(props: ErrorPageProps) {\r\n    super(props);\r\n  }\r\n\r\n  init() {\r\n    this.children = {\r\n      Link: new Button({ text: \"На главную\", href: PAGES.index, attributes: { class: \"error-page__link\" } }),\r\n    };\r\n  }\r\n\r\n  render() {\r\n    return this.compile(template, this.props);\r\n  }\r\n}\r\n\r\nexport default ErrorPage;\r\n","import RegistrationPage from '../pages/registration/RegistrationPage';\r\nimport AuthPage from '../pages/authentication/AuthPage';\r\nimport PaginationPage from '../pages/pagination/Pagination';\r\nimport ProfilePage from '../pages/profile/Profile';\r\nimport ProfileEditPage from '../pages/profileEdit/ProfileEdit';\r\nimport ChangePasswordPage from '../pages/changePassword/ChangePassword';\r\nimport ChatsPage from '../pages/main/Chats';\r\nimport Block from '../components/Block/Block';\r\nimport unknownPage from '../pages/errors/404';\r\nimport serverErrorPage from '../pages/errors/500';\r\n\r\nexport const enum PAGES {\r\n  index = '/messenger',\r\n  unknown = '/404',\r\n  serverError = '/500',\r\n  auth = '/',\r\n  registration = '/sign-up',\r\n  pagination = '/pagination',\r\n  profile = '/settings',\r\n  profileEdit = '/settings/edit',\r\n  changePassword = '/change-password'\r\n}\r\n\r\nexport const PAGES_ROUTES: Record<string, typeof Block> = {\r\n  [PAGES.index]: ChatsPage,\r\n  [PAGES.unknown]: unknownPage, \r\n  [PAGES.serverError]: serverErrorPage, \r\n\t[PAGES.auth]: AuthPage,\r\n  [PAGES.registration]: RegistrationPage,\r\n  [PAGES.pagination]: PaginationPage,\r\n  [PAGES.profile]: ProfilePage,\r\n  [PAGES.profileEdit]: ProfileEditPage,\r\n  [PAGES.changePassword]: ChangePasswordPage,\r\n}\r\n\r\nexport default function renderDOM(rootQuery: string, Component: Block): void {\r\n  const root = document.querySelector(rootQuery);\r\n  if(root) {\r\n    root.appendChild(Component.getContent());\r\n    Component.dispatchComponentDidMount();\r\n  }\r\n}\r\n","import ErrorPage from \"./ErrorPage\";\r\n\r\nexport default class unknownPage extends ErrorPage {\r\n\tconstructor() {\r\n\t\tsuper({ status: 404, statusText: \"Страница ушла, но обещала вернуться\"});\r\n\t}\r\n}\r\n","import ErrorPage from \"./ErrorPage\";\r\n\r\nexport default class serverErrorPage extends ErrorPage {\r\n\tconstructor() {\r\n\t\tsuper({ status: 500, statusText: \"У нас что-то поломалось, уже чиним\"});\r\n\t}\r\n}\r\n","import Block from \"../../components/Block/Block\";\r\nimport renderDOM from \"../../utils/renderDOM\";\r\n\r\nfunction isEqual(lhs: string, rhs: string): boolean {\r\n  return lhs === rhs;\r\n}\r\n\r\nclass Route {\r\n  _pathname: string;\r\n  _block: Block | null;\r\n  _blockClass: typeof Block;\r\n  _props: Record<string, any>;\r\n\r\n  constructor(pathname: string, blockClass: typeof Block, props: Record<string, any>) {\r\n    this._pathname = pathname;\r\n    this._block = null;\r\n    this._blockClass = blockClass;\r\n    this._props = props;\r\n  }\r\n\r\n  navigate(pathname: string) {\r\n    if (this.match(pathname)) {\r\n      this._pathname = pathname;\r\n      this.render();\r\n    }\r\n  }\r\n\r\n  leave() {\r\n    if (this._block) {\r\n      this._block.unmount();\r\n    }\r\n  }\r\n\r\n  match(pathname: string) {\r\n    return isEqual(pathname, this._pathname);\r\n  }\r\n\r\n  render() {\r\n    if (!this._block) {\r\n      this._block = new this._blockClass();\r\n    }\r\n\r\n    renderDOM(\"#app\", this._block);\r\n  }\r\n}\r\n\r\nexport default Route;\r\n","import Block from \"../../components/Block/Block\";\r\nimport Route from \"./Route\";\r\n\r\nclass Router {\r\n  private static __instance: Router;\r\n  routes: Route[];\r\n  history: History;\r\n  _currentRoute: Route | null;\r\n  _rootQuery: string;\r\n\r\n  constructor(rootQuery: string) {\r\n    if (Router.__instance) {\r\n      return Router.__instance;\r\n    }\r\n\r\n    this.routes = [];\r\n    this.history = window.history;\r\n    this._currentRoute = null;\r\n    this._rootQuery = rootQuery;\r\n\r\n    Router.__instance = this;\r\n  }\r\n\r\n  use(pathname: string, block: typeof Block) {\r\n    const route = new Route(pathname, block, { rootQuery: this._rootQuery });\r\n    this.routes.push(route);\r\n\r\n    return this;\r\n  }\r\n\r\n  start() {\r\n    window.addEventListener(\"popstate\", (state: PopStateEvent) => {\r\n      this._onRoute((state.currentTarget as Window)?.location.pathname);\r\n    });\r\n\r\n    this._onRoute(window.location.pathname);\r\n  }\r\n\r\n  _onRoute(pathname: string) {\r\n    const route = this.getRoute(pathname) || this.getRoute(\"/404\");\r\n\r\n    if (this._currentRoute && this._currentRoute !== route) {\r\n      this._currentRoute.leave();\r\n    }\r\n\r\n    if (route) {\r\n      this._currentRoute = route;\r\n      route.render();\r\n    }\r\n  }\r\n\r\n  go(pathname: string) {\r\n    this.history.pushState({}, \"\", pathname);\r\n    this._onRoute(pathname);\r\n  }\r\n\r\n  back() {\r\n    this.history.back();\r\n  }\r\n\r\n  forward() {\r\n    this.history.forward();\r\n  }\r\n\r\n  getRoute(pathname: string) {\r\n    return this.routes.find((route) => route.match(pathname));\r\n  }\r\n}\r\n\r\nconst router = new Router(\"#app\");\r\n\r\nexport { Route, router as Router };\r\n","import AuthAPI from \"../API/AuthAPI\";\r\nimport { Router } from \"../Modules/Router/Router\";\r\nimport Store from \"../Modules/Store/Store\";\r\nimport { PAGES, PAGES_ROUTES } from \"../utils/renderDOM\"\r\n\r\nconst AuthAPIEntity = new AuthAPI();\r\n\r\nObject.keys(PAGES_ROUTES).forEach((pathname: string) => {\r\n  Router.use(pathname, PAGES_ROUTES[pathname]);\r\n});\r\n\r\nAuthAPIEntity.getUser().then(user => {\r\n  if(user) {\r\n    Store.set('user', user);\r\n    \r\n    setInterval(() => {\r\n      AuthAPIEntity.getUser().then(user => {\r\n        if(!user) {\r\n          Store.set('user', undefined);\r\n          Router.go(PAGES['auth'])\r\n        } else {\r\n          Store.set('user', {...user});\r\n        }\r\n      });\r\n    }, 5000);\r\n  }\r\n  Router.start();\r\n});\r\n\r\ndocument.addEventListener(\"click\", function(event: Event) {\r\n  let target = event.target as HTMLElement;\r\n  if(target.nodeName !== \"A\") {\r\n    target = target.closest(\"a\") || target;\r\n  }\r\n  const link = target.getAttribute('href');\r\n  if(target && (target.closest(\"a\") || target.nodeName === \"A\") &&  link !== null) {\r\n    event.preventDefault();\r\n    Router.go(link);\r\n  }\r\n});\r\n"],"names":["$00d5401ccbe0b998$var$isArrayOrObject","value","constructor","Object","prototype","toString","call","$00d5401ccbe0b998$var$isPlainObject","Array","isArray","$00d5401ccbe0b998$var$isArray","$00d5401ccbe0b998$export$2e2bcd8739ae039","$00d5401ccbe0b998$var$queryStringify","data","resultStr","key","entries","forEach","subkey","subval","push","join","$f42148851fb6f71a$var$METHODS","$f42148851fb6f71a$export$2e2bcd8739ae039","baseUrl","this","_baseUrl","get","url","options","timeout","request","method","put","post","delete","Promise","resolve","reject","headers","xhr","XMLHttpRequest","open","withCredentials","handleError","err","status","response","reason","message","header","setRequestHeader","onerror","onabort","ontimeout","timer","setTimeout","abort","onload","JSON","parse","clearTimeout","send","$8bd45cafb7af6a7f$export$2e2bcd8739ae039","HTTPEntity","$2971b4125730db8f$export$2e2bcd8739ae039","super","async","logout","$391410eac4ca7f7a$export$2e2bcd8739ae039","locals","pug_interp","pug_html","locals_for_with","RegistrationForm1","RegistrationForm","undefined","$74a81cbf0b783735$export$2e2bcd8739ae039","listeners","on","event","callback","off","Error","filter","listener","emit","args","$7ffc1f94643dc7e4$export$2e2bcd8739ae039","crypto","randomUUID","bind","$568f4ee4022ba00e$var$getRandomValues","$568f4ee4022ba00e$var$rnds8","Uint8Array","$568f4ee4022ba00e$export$2e2bcd8739ae039","getRandomValues","$1d0137947e8554ce$var$byteToHex","i","slice","$1d0137947e8554ce$export$8fb373d660548968","arr","offset","toLowerCase","$3fa3ae484854b431$export$2e2bcd8739ae039","buf","rnds","random","rng","$7a4b893553ba843a$export$53975f9864de287c","$7a4b893553ba843a$export$53b83ca8eaab0383","$7a4b893553ba843a$export$43bee75e5e14138e","$b44be997b14bc7a5$export$2e2bcd8739ae039","$b44be997b14bc7a5$var$deepEqual","lhs","rhs","keys","length","rightValue","$3e42f02f710de4e9$var$EVENTS","EVENTS","$3e42f02f710de4e9$export$2e2bcd8739ae039","propsAndChildren","eventBus","children","props","_getChildren","id","_element","_meta","_makePropsProxy","_registerEvents","INIT","_init","FLOW_CDM","_componentDidMount","FLOW_CDU","_componentDidUpdate","FLOW_CU","_componentUpdated","FLOW_RENDER","_render","FLOW_UM","_addEvents","events","eventName","addEventListener","_removeEvents","removeEventListener","init","componentDidMount","values","child","subChild","dispatchComponentDidMount","oldProps","newProps","componentDidUpdate","componentUpdated","_componentBeforeUnmount","componentBeforeUnmount","setProps","nextProps","assign","element","block","render","newElement","firstChild","replaceWith","compile","template","propsAndStubs","map","fragment","_createDocumentElement","innerHTML","stub","content","querySelector","getContent","Proxy","target","property","set","receiver","stringify","isUpdated","Reflect","tagName","document","createElement","show","style","display","hide","unmount","outerHTML","$962598ba441e4011$var$pug_attr","t","e","n","r","f","toJSON","indexOf","$962598ba441e4011$var$pug_escape","replace","$962598ba441e4011$var$pug_classes","s","a","u","c","g","$962598ba441e4011$var$pug_classes_array","o","$962598ba441e4011$var$pug_has_own_property","$962598ba441e4011$var$pug_classes_object","$962598ba441e4011$var$pug_match_html","exec","index","charCodeAt","substring","hasOwnProperty","$962598ba441e4011$var$pug_merge","arguments","l","concat","$962598ba441e4011$var$pug_style","$962598ba441e4011$export$2e2bcd8739ae039","attributes1","className1","error1","label1","$962598ba441e4011$var$pug_attrs","class","type","attributes","className","error","label","$721664b0ea08f320$export$9a34b617756697a1","email","login","first_name","second_name","display_name","phone","avatar","password","$721664b0ea08f320$export$5516eb36ec6a702b","RegExp","$721664b0ea08f320$export$114d6779c66b5128","$88d454991c3ed41f$export$2e2bcd8739ae039","validation","inputIsValid","name","match","includes","blurEvent","nodeName","clickEvent","classList","contains","closest","input","change","click","$6b5d8bd0804f5f10$var$pug_attr","$6b5d8bd0804f5f10$var$pug_escape","$6b5d8bd0804f5f10$var$pug_classes","$6b5d8bd0804f5f10$var$pug_classes_array","$6b5d8bd0804f5f10$var$pug_has_own_property","$6b5d8bd0804f5f10$var$pug_classes_object","$6b5d8bd0804f5f10$var$pug_match_html","$6b5d8bd0804f5f10$export$2e2bcd8739ae039","ActionBtn1","Link1","id1","inputs1","isModal1","title1","ActionBtn","Link","inputs","isModal","title","$5724256c4ccdba1a$export$2e2bcd8739ae039","isValid","$cd609aea50eea921$var$pug_attr","$cd609aea50eea921$var$pug_escape","$cd609aea50eea921$var$pug_attrs","$cd609aea50eea921$var$pug_has_own_property","$cd609aea50eea921$var$pug_classes","$cd609aea50eea921$var$pug_style","$cd609aea50eea921$var$pug_classes_array","$cd609aea50eea921$var$pug_classes_object","$cd609aea50eea921$var$pug_match_html","$cd609aea50eea921$var$pug_merge","$cd609aea50eea921$export$2e2bcd8739ae039","href1","text1","href","text","$60da8b7124b44505$export$2e2bcd8739ae039","$0c58b7f2c71222a8$export$9643fd7297feaaf5","returnObj","$0c58b7f2c71222a8$export$18d3a16198f06b4c","$bb6297e2ebc7fc84$export$2e2bcd8739ae039","$bb6297e2ebc7fc84$var$merge","p","$3d7b9e5a4f7dfbe6$export$2e2bcd8739ae039","object","path","result","split","reduceRight","acc","$ad0672101bd176d7$export$84bc128a772952e2","$ad0672101bd176d7$var$store","state","getState","$ad0672101bd176d7$export$64605811ab45167f","Component","mapStateToProps","lastComponentState","Updated","$ad0672101bd176d7$export$2e2bcd8739ae039","$711560d73fda91b6$export$2e2bcd8739ae039","isAuthed","user","redirectToIndex","$65f7baf0da275b66$export$55185c17a0fcbe46","go","$548925ac852a678a$export$bf0267afb2fbc151","redirectToLogin","getUser","$7aaca05d15f9406a$var$RegistrationAPIEntity","signup","registrationData","$ef4f3cd310700290$var$RegistrationControllerEntity","$ef4f3cd310700290$var$INPUT_CLASS","$ef4f3cd310700290$export$2e2bcd8739ae039","placeholder","auth","submit","preventDefault","currentForm","FormData","$036f4179399ee4cf$export$2e2bcd8739ae039","AuthForm1","AuthForm","$f455692060687844$var$AuthAPIEntity","signin","$f455692060687844$export$2e2bcd8739ae039","then","$b46e7626dcef6b0e$var$AuthControllerEntity","$b46e7626dcef6b0e$var$INPUT_CLASS","$b46e7626dcef6b0e$export$2e2bcd8739ae039","registration","$8bce1c22279f304b$export$2e2bcd8739ae039","links1","links","$ad378e5589b98133$var$btnStyle","$ad378e5589b98133$export$2e2bcd8739ae039","profile","profileEdit","changePassword","unknown","serverError","$051ad4e0383f407c$var$pug_attr","$051ad4e0383f407c$var$pug_escape","$051ad4e0383f407c$var$pug_match_html","$051ad4e0383f407c$export$2e2bcd8739ae039","Photo1","backUrl1","changePasswordUrl1","changeProfileUrl1","fieldsNaming1","user1","$$obj","$$l","val","Photo","backUrl","changePasswordUrl","changeProfileUrl","fieldsNaming","$8504d8f44e39b19d$var$pug_attr","$8504d8f44e39b19d$var$pug_escape","$8504d8f44e39b19d$var$pug_classes","$8504d8f44e39b19d$var$pug_classes_array","$8504d8f44e39b19d$var$pug_has_own_property","$8504d8f44e39b19d$var$pug_classes_object","$8504d8f44e39b19d$var$pug_match_html","$8504d8f44e39b19d$export$2e2bcd8739ae039","ChangePhotoModal1","canChange1","photoSrc1","alt","ChangePhotoModal","canChange","photoSrc","$d30ef85a17a52ae4$var$pug_attr","$d30ef85a17a52ae4$var$pug_escape","$d30ef85a17a52ae4$var$pug_classes","$d30ef85a17a52ae4$var$pug_classes_array","$d30ef85a17a52ae4$var$pug_has_own_property","$d30ef85a17a52ae4$var$pug_classes_object","$d30ef85a17a52ae4$var$pug_match_html","$d30ef85a17a52ae4$export$2e2bcd8739ae039","FileInput1","SaveBtn1","errorText1","FileInput","SaveBtn","errorText","$f9399a3b0060f36e$var$pug_attr","$f9399a3b0060f36e$var$pug_escape","$f9399a3b0060f36e$var$pug_classes","$f9399a3b0060f36e$var$pug_classes_array","$f9399a3b0060f36e$var$pug_has_own_property","$f9399a3b0060f36e$var$pug_classes_object","$f9399a3b0060f36e$var$pug_match_html","$f9399a3b0060f36e$export$2e2bcd8739ae039","accept1","currentImg1","imgName1","name1","accept","currentImg","imgName","$9562e125470816e2$export$2e2bcd8739ae039","files","file","startsWith","fileBase64","reader","FileReader","readAsDataURL","$ffc59ece198f3b2e$export$2e2bcd8739ae039","getFile","$1c3220f9a1e0e1eb$export$2e2bcd8739ae039","stopPropagation","ModalEl","formData","append","formSubmitCallback","toggle","$4461f9cb1cb4facd$export$2e2bcd8739ae039","console","log","$af994c25e51d1ae7$export$2e2bcd8739ae039","$6f0966a1dee2f954$export$2e2bcd8739ae039","$cc905ff38436590a$export$2e2bcd8739ae039","eTarget","$5a3a39b3f09df636$var$pug_escape","$5a3a39b3f09df636$var$pug_match_html","$5a3a39b3f09df636$export$2e2bcd8739ae039","EditForm1","$5a3a39b3f09df636$var$pug_attr","EditForm","$56c0386deb19129b$export$2e2bcd8739ae039","$3738eb51151e4916$var$ProfileEditAPIEntity","changeUser","changePhoto","$3738eb51151e4916$export$2e2bcd8739ae039","userData","$65f94d4366073003$var$AuthControllerEntity","$65f94d4366073003$var$ProfileEditControllerE","$65f94d4366073003$var$INPUT_CLASS","$65f94d4366073003$export$2e2bcd8739ae039","changeAvatar","changeData","$3226ce300024bed5$var$pug_attr","$3226ce300024bed5$var$pug_match_html","$3226ce300024bed5$var$pug_escape","$3226ce300024bed5$export$2e2bcd8739ae039","$fc5f9fee760641ef$export$2e2bcd8739ae039","$22f47558c75f6ea0$export$2e2bcd8739ae039","$87cc11b980ae599a$var$AuthControllerEntity","$87cc11b980ae599a$export$2e2bcd8739ae039","validate","querySelectorAll","currentType","parentElement","remove","add","passElement","confirmElement","$95151f16b4d248a5$var$pug_escape","$95151f16b4d248a5$var$pug_match_html","$95151f16b4d248a5$export$2e2bcd8739ae039","ActiveChat1","ChatsList1","Modals1","UserPhoto1","profileUrl1","$95151f16b4d248a5$var$pug_attr","ActiveChat","ChatsList","Modals","UserPhoto","profileUrl","$15574cb45a6b1371$var$pug_attr","$15574cb45a6b1371$var$pug_escape","$15574cb45a6b1371$var$pug_classes","$15574cb45a6b1371$var$pug_classes_array","$15574cb45a6b1371$var$pug_has_own_property","$15574cb45a6b1371$var$pug_classes_object","$15574cb45a6b1371$var$pug_match_html","$15574cb45a6b1371$export$2e2bcd8739ae039","date1","isActive1","isUserMessageLast1","last_message1","messageCount1","date","isActive","isUserMessageLast","last_message","messageCount","$abfdd33602893b7d$export$2e2bcd8739ae039","messageDate","Date","time","inputDate","todaysDate","setHours","$abfdd33602893b7d$var$dateIsToday","getHours","getMinutes","toLocaleString","year","month","day","Number","unread_message","$ce4339273ffe14bc$var$pug_escape","$ce4339273ffe14bc$var$pug_match_html","$ce4339273ffe14bc$export$2e2bcd8739ae039","MessageFormEl1","Messages1","$ce4339273ffe14bc$var$pug_attr","MessageFormEl","Messages","$ae6c8d6e764f334b$var$pug_attr","$ae6c8d6e764f334b$var$pug_escape","$ae6c8d6e764f334b$var$pug_classes","$ae6c8d6e764f334b$var$pug_classes_array","$ae6c8d6e764f334b$var$pug_has_own_property","$ae6c8d6e764f334b$var$pug_classes_object","$ae6c8d6e764f334b$var$pug_match_html","$ae6c8d6e764f334b$export$2e2bcd8739ae039","isIncoming1","isMedia1","src1","time1","isIncoming","isMedia","src","$543b77bc9ebffff8$export$2e2bcd8739ae039","$c569f277cfa3c231$var$pug_attr","$c569f277cfa3c231$var$pug_escape","$c569f277cfa3c231$var$pug_classes","$c569f277cfa3c231$var$pug_classes_array","$c569f277cfa3c231$var$pug_has_own_property","$c569f277cfa3c231$var$pug_classes_object","$c569f277cfa3c231$var$pug_match_html","$c569f277cfa3c231$export$2e2bcd8739ae039","Button1","content1","input1","Button","$05539b732445cfe7$export$2e2bcd8739ae039","getData","reset","$15d2279979ba050e$export$2e2bcd8739ae039","$df988473a8a2355c$export$2e2bcd8739ae039","form","dispatchEvent","CustomEvent","detail","bubbles","$67b0ae5617a60076$export$2e2bcd8739ae039","changePhotoModal","addPhotoModal","addFileModal","addUserModal","removeUserModal","MessageFormElement","removeChatModal","Event","activeChat","messages","fillMessages","currentUser","isCurrentUser","user_id","messageTime","messageBlock","$2d6b7fcdff282229$export$2e2bcd8739ae039","getChats","addChat","removeChat","chatId","addUser","userId","users","removeUser","getToken","$46551cc3610a32a5$export$2e2bcd8739ae039","searchByLogin","$f5b970b0996378a2$export$2e2bcd8739ae039","token","messageAmount","connect","socket","WebSocket","getOld","addEvents","supportConnecting","onClose","onMessage","onError","setInterval","wasClean","code","processNewMessage","processOldMessages","getSocket","sendMessage","allMessages","reverse","$64919aed7690a118$export$2e2bcd8739ae039","userLogin","shift","replaceAll","$1f6a8d7319264cd1$var$AuthControllerEntity","$1f6a8d7319264cd1$export$2e2bcd8739ae039","addChatModal","updateChats","openMenu","dataset","modal","actionBtn","chats","chat","chooseChat","connectToChat","updated","menuBtn","from","$a688e44dbbb84d66$var$pug_escape","$a688e44dbbb84d66$var$pug_match_html","$a688e44dbbb84d66$export$2e2bcd8739ae039","status1","statusText1","statusText","$5ce2877a7308fadf$export$2e2bcd8739ae039","PAGES","$548925ac852a678a$export$198758fb20cf9c24","$548925ac852a678a$export$2e2bcd8739ae039","rootQuery","root","appendChild","$f37cd2ee65777673$export$2e2bcd8739ae039","pathname","blockClass","_pathname","_block","_blockClass","_props","navigate","leave","$65f7baf0da275b66$var$Router","__instance","routes","history","window","_currentRoute","_rootQuery","use","route","start","_onRoute","currentTarget","location","getRoute","pushState","back","forward","find","$66bd2f909dab14d6$var$AuthAPIEntity","link","getAttribute"],"version":3,"file":"index.3025e2e4.js.map"}